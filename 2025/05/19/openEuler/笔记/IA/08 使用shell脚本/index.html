<!DOCTYPE html><html lang="zh" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>08 使用shell脚本 | XBCID's BLOG</title><meta name="keywords" content="Linux,openEuler,Huawei,HCIA"><meta name="author" content="XBCID"><meta name="copyright" content="XBCID"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="08 使用shell脚本"><meta name="application-name" content="08 使用shell脚本"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="08 使用shell脚本"><meta property="og:url" content="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/index.html"><meta property="og:site_name" content="XBCID's BLOG"><meta property="og:description" content="本课程基于 openEuler 介绍关于 Shell 的基础知识 结合实际案例展示 Shell 脚本编写的最佳实践  学完本课程后，您应该能：  熟悉 Shell 基础知识 掌握 Shell 编程基础 能够编写常用的 Shell 脚本    0x01 Shell基础介绍1.1 openEuler构"><meta property="og:locale" content="zh"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="XBCID"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="本课程基于 openEuler 介绍关于 Shell 的基础知识 结合实际案例展示 Shell 脚本编写的最佳实践  学完本课程后，您应该能：  熟悉 Shell 基础知识 掌握 Shell 编程基础 能够编写常用的 Shell 脚本    0x01 Shell基础介绍1.1 openEuler构"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: XBCID","link":"链接: ","source":"来源: XBCID's BLOG","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'XBCID's BLOG',
  title: '08 使用shell脚本',
  postAI: '',
  pageFillDescription: '0x01 Shell基础介绍, 1.1 openEuler构成Shell简介, 1.1.1 Shell 概述, 1.1.2 Shell发展史, 1.1.4 查看Shell, 1.2 Shell脚本（定义、作用、格式、权限及执行）, 1.2.1 Shell脚本基础知识, 1.2.2 Shell脚本的约束, 1.2.3 Shell脚本开发环境, 1.2.4 Shell脚本指定解释器, 1.2.5 执行Shell脚本, 1.2.6 后台执行Shell脚本, 0x02 Shell编程基础, 2.1 输入输出、管道, 2.1.1 Linux中的文本流, 2.1.2 输出重定向, 2.1.3 输入重定向, 2.1.4 管道, 2.2 字符、变量、运算, 2.2.1 Shell中的字符, 2.2.2 变量, 2.2.2.1 变量的类型, 2.2.2.2 使用变量(单、双引号), 2.2.2.3 扩展变量, 2.2.2.4 变量的赋值与输出, 2.2.3 Shell的算术扩展, 2.2.3.1 在Shell中计算时间, 2.2.3.2 算术运算常用表达式, 2.2.3.2.1 算术运算的优先级, 2.2.3.2.2 变量递增的前置后置区别, 2.3 语句（条件循环）, 2.3.1 Shell 中的结构化命令, 2.3.2 条件语句, 2.3.2.1 多分支判断语句, 2.3.3 循环语句, 2.3.3.1 for循环, 2.3.3.2 for循环中的列表, 2.3.3.3 for循环奇数累加器, 2.3.3.4 for循环文件展示, 2.3.3.5 while循环, 2.3.3.6 until循环, 2.3.3.7 使用循环打印乘法表, 0x03 Shell编程最佳实践, 3.1 调试, 3.1.1 Shell 脚本错误故障排除, 3.1.2 调试模式, 3.1.3 评估退出代码, 3.2 语法风格, 3.2.1 良好风格, 3.3 最佳实践范例, 3.3.1 监测日志告警信息并邮件通知, 0x04 本章总结, 0x05 Shell脚本的一些注意点, 为什么需要使用 $()？, 另一种命令替换的方式：反引号（````）, 方括号的使用本课程基于介绍关于的基础知识结合实际案例展示脚本编写的最佳实践学完本课程后您应该能熟悉基础知识掌握编程基础能够编写常用的脚本基础介绍构成简介了解在中的位置掌握脚本的基本操作概述是系统的用户界面提供了用户与内核进行交互操作的一种接口将用户输入的命令并且把它们送到内核去执行然后返回执行结果是可编程的它允许用户编写由命令组成的程序发展史的为开发了第一个是一个在内核之外执行的独立的用户程序在为创建在伯克利分校攻读研究生期间为系统开发的在卡内基梅隆大学开发了将引入了系统中的一些功能如命令行编辑功能和文件名和命令自动补全功能在创建它功能更强大提供关联数组表达式运算或是一个开源项目旨在取代由开发已成为世上最流行的它兼容是系统的默认在中有多种程序可供选择比如等默认的可以在查看在中修改查看登陆查看系统默认安装的查看当前登陆用户默认查看当前的脚本定义作用格式权限及执行脚本基础知识在里一个程序命令只做好一件事复杂的问题可以通过多个命令的组合来解决形式最简单的脚本就是一系列命令构成的可执行文件并可以被其他脚本复用编写风格良好易读的脚本可以提高日常任务的自动化程度和准确性脚本的约束没有银弹脚本可以完成很多任务但不适用于所有情况对于可以通过调用其他命令行实用工具来完成的任务脚本是一种不错的选择脚本可以作为一种胶水语言整合其他编程语言银弹没有一个工具可以解决所有问题当解决某个问题时脚本实现起来复杂度高效率低此时就可以考虑使用其他编程语言脚本开发环境可以在任意文本编辑器中打开新文件来创建脚本高级编辑器如和在识别文件的后缀为后可以提供语法高亮检查补全等功能新建一个脚本文件并写入如下内容脚本指定解释器脚本只是静态的代码若要输出结果还需要解释器的参与一般在脚本的第一行指定执行此脚本的解释器如果不指定解释器脚本也能在默认的解释器中正常运行但出于规范和安全的考虑建议指定如下执行脚本对于脚本文件我们有两种执行方式中一切皆文件脚本命令程序都是一个文件文件作为一个对象具有权限的属性在执行别人发送或从网上下载的脚本时可能会遇到权限问题赋予执行权限可解决如果某个脚本可执行则可以通过在命令行中输入其名称调用如果某个脚本可执行则可以通过在命令行中输入其名称调用查看变量修改变量查找某个命令脚本的路径永久修改需要在或中添加关于变量的细节后续章节还会提到后台执行脚本有时候一些脚本执行时间较长命令行界面会被占用因此可以采取后台运行脚本这种方法在退出后脚本进程会随之终止为了保证脚本一直运行可以采用脚本的标准输出和标准错误会重定向到文件里使用命令可以查看后台中运行着的进程编程基础理解中文本流的输入输出以及重定向掌握中管道的用法掌握中的变量运算符掌握中的逻辑判断选择结构循环结构输入输出管道中的文本流文本流存在于的每一个进程中的每个进程启动时会打开三个文本流的端口标准输入标准输出标准错误这三个端口对应着一个程序的输入输出和异常的抛出例如在中输入一串字符后进程中的标准输入端口捕获命令行中的输入进行处理后从标准输出端口中传出回显在屏幕上如果处理过程中发生异常则会通过标准错误端口将异常回显在屏幕上输出重定向某些情况下我们需要保存程序的输出此时就可以通过重定向将程序的输出保存到文件中将标准输出定向到文件中使用这种方式会将程序的标准输出覆盖文件内容将标准输出追加到文件中使用这种方式会将标准输出追加至文件的末尾执行完命令后可以通过查看保存的文件内容输入重定向与输出重定向类似输入重定向是把程序的标准输入进行重新定向输入重定向格式将右边的文件作为标准输入然后传入左边的命令例内联输入重定向格式输出重定向需要文件而内联输入重定向可以使用即时输入的文本作为标准输入传入左边的命令右边的字符作为标志表示标准输入的开始和结束自身不包含在标准输入里右图例中以作为标志管道有时需要将一个命令的输出连到另一个命令的输入如果用重定向实现会较复杂管道就像现实中的水管一样可以连接两个命令的输入和输出甚至是串联多个命令格式管道实际上是进程间通信的一种方式字符变量运算中的字符和其他编程语言一样也有一些保留字特殊字符在编写脚本时需要注意注释符号在文件的行首作为标记其他地方作为注释作用在一行中后面的内容并不会被执行除非但是用单双引号包围时作为号字符本身不具有注释作用单引号单引号括住的内容被视为单一字符串引号内的禁止变量扩展所有字符均作为字符本身处理除单引号本身之外单引号必须成对出现反斜线反斜杆放在特殊符号之前转义特殊符号的作用仅表示特殊符号本身这在字符串中常用放在一行指令的最末端表示紧接着的回车无效其实也就是转义了后继新行的输入仍然作为当前指令的一部分斜线斜杆作为路径的分隔符路径中仅有一个斜杆表示根目录以斜杆开头的路径表示从根目录开始的路径在作为运算符的时候表示除法符号如感叹号取反一个测试结果或退出状态表示反逻辑比如后面的这个是表示不等于表示取反如表示后面不是紧接一个数字的文件变量任何语言都有变量这个要素与其他强类型的编程语言如和等有很大不同中的变量是无类型的通过一个变量我们可以引用一块内存区域的值变量名就是这块内存区域上贴的一个标签变量赋值变量的类型在中变量主要有两大类环境变量用户定义变量每种类型的变量依据作用域不同又分为全局变量和局部变量全局变量作用在整个会话及其子局部变量作用在定义她们的进程及其子进程内查看变量使用查看全局变量使用查看某个特定进程中的所有变量包括局部变量全局变量以及用户定义变量修改变量在或中添加语句永久修改变量对比与的区别命令是中的一个内建命令它能够显示当前中的变量以及用户自定义的变量不管该变量有没有命令允许你更改选项的值并设置位置参数或者显示变量的名称和值如果未提供任何选项或参数则会设置显示所有变量和函数的名称和值按照当前语言环境排序并且输出的格式可以重新用作设置或重置当前设置变量的输入和在环境变量打印方面是类似的但是在功能上主要用于设置环境变量并运行指定的命令命令而是为了打印环境变量则是一个的内建命令与有关用于设置的属性使用变量单双引号变量命名规则变量名由数字字母下划线组成必须以字母或者下划线开头不能使用里的关键字定义变量的格式赋值号的周围不能有空格如果有必要也可以使用关键字显式定义变量的类型查询关键字如果包含了空白符则需要用引号包裹起来单引号包裹的内容不展开命令变量即原样输出双引号反之会展开其中包裹的命令和变量扩展变量在以下示例中如果不使用花括号会将解释为变量后跟变量而不是由字符分隔的变量和因此在此情况下必须使用花括号引用的形式才能使变量扩展正确运行变量的赋值与输出定义并赋值如下变量个人姓名日期输出姓名及日期变量读取输入并输出命令等待用户输入随后将输入的内容赋给变量的算术扩展算术扩展可用于执行简单的整数算术运算语法表达式例在中计算时间定义小时分钟秒变量定义每天秒数变量并赋值输出变量算术运算常用表达式算术运算的优先级优先级由高到低如下变量递增的前置后置区别和输出是否一样在触发边界条件时有哪些场景需要注意要开辟一个变量来保存的值并返回然后让这个变量的值而直接把加到这个变量的空间中去并返回这个空间中的值没有开辟任何临时空间性能更高图中返回的变量是所以有这样的差异语句条件循环中的结构化命令在脚本里除了顺序执行还需要一些额外的逻辑控制流程和其他编程语言类似中的结构化命令主要包括条件循环两类条件语句语句语法会先执行后面的语句如果其退出状态码为则会继续执行部分的命令否则会执行脚本中的下一个命令中的和其他判断的条件不太一样需注意多分支判断语句在涉及多条件判断时可能会使用较为繁琐的语句通过语句频繁检测同一个变量的值此时更适合使用语句语法语句会将指定的变量与不同的模式比较若匹配则执行对应的命令用可以分割出多个模式用代表所有与已知模式不匹配的值循环语句脚本中常会遇到一些重复任务相当于循环执行一组命令直到满足了某个特定条件常见的循环语句有种循环控制符有两种用于控制循环流程的转向循环语法风格语法语言风格和之间的命令称为循环体执行次数和列表中常数或字符串的个数相同循环首先将后列表的第一个常数或字符串赋值给循环变量然后执行循环体以此执行最后执行命令后的命令序列循环中的列表循环奇数累加器循环文件展示展示目录下所有文件参考脚本循环也称为前测试循环语句重复次数是利用一个条件来控制是否继续重复执行这个语句为避免死循环必须保证循环体中包含循环出口条件此处示例等同于此前奇数累加器思考与循环实现方式相比有何不同循环与循环类似但是跳出循环的条件判断有所区别奇数累加器此处示例脚本等同于此前奇数累加器思考与循环循环实现方式相比有何不同使用循环打印乘法表参考脚本编程最佳实践掌握的调试模式掌握脚本的基本调试方法了解脚本编写过程中应遵循的良好风格掌握常见脚本的编写方法调试脚本错误故障排除编写使用或维护脚本的管理员不可避免地会遇到脚本的错误错误通常是由于输入错误语法错误或脚本逻辑不佳导致在编写脚本时将文本编辑器与语法高亮显示结合使用可以帮助使错误更明显找到并排除脚本中错误的最直接方法是调试避免在脚本中引入错误的另一种简单方法是在创建脚本期间遵循良好风格调试模式脚本上激活调试模式请向脚本第一行中的命令解释器中添加选项如此前乘法表进行如下修改的调试模式将打印出脚本执行前由脚本执行的命令已执行的所有扩展的结果都将显示在打印输出中所有变量数据状态会实时打印以供跟踪评估退出代码每个命令返回一个退出状态也通常称为返回状态或退出代码退出代码可以用于脚本的调试以下示例说明了几个常用命令的执行和退出状态检索在脚本中使用退出代码一旦执行脚本将在其处理所有内容之后退出但是有时候可能需要中途退出脚本比如在遇到错误条件时可以通过在脚本中使用命令来实现这一目的当脚本遇到命令时脚本将立即退出并跳过对脚本其余内容的处理语法风格良好风格以下是要遵循的一些具体做法将长命令分解为多行更小的代码块代码段越短就越便于读者领悟和理解将多个语句的开头和结尾排好以便于查看控制结构的开始和结束位置以及它们是否正确关闭对包含多行语句的行进行缩进以表示代码逻辑的层次结构和控制结构的流程使用行间距分隔命令块以阐明一个代码段何时结束以及另一个代码段何时开始在整个脚本中通篇使用一致的格式添加注释和空格如何能够极大改善脚本可读利用这些简单做法极大方便了用户在编写期间发现错误还提高了脚本对于将来读者的可读性脚本示例修改后的脚本此脚本是读取关于相关的软件包信息并从数据库中查询软件包的安装时间循环处理信息查询每个软件包的安装时间把时间转换为普通的日期时间打印信息最佳实践范例监测日志告警信息并邮件通知场景描述某运营商要求对当前环境日志文件进行长期监测如发现关键词则发送告警邮件要求日志文件可自己新建用脚本模拟写入发送邮件可通过指令但受限实验环境可通过向日志文件写入字符串来替代实现效果后台运行监测脚本模拟报错查看文件检查结果日志检测脚本模拟报错脚本本章总结本章系统介绍了脚本中的各个要素包括执行编写调试在执行部分介绍了工作中常用的前台后台运行方式及对应操作在编写部分介绍了编写脚本所需的变量语句结构等知识在调试部分介绍了常见的调试方法和编写过程中良好风格本章提供了大量的实际案例和示例代码有助于实际工作中的使用脚本的一些注意点在中变量赋值时等号两边不能有空格在中是用于命令替换的语法它允许你将命令的输出结果作为表达式的一部分并将其赋值给一个变量或者在其他命令中使用为什么需要使用获取命令输出用于获取命令的输出并将其替换到变量或其他表达式中换句话说是一种将命令的标准输出嵌入到其他命令或赋值中的方式防止语法错误如果没有或者反引号会将整个命令当作普通的字符串处理而不是执行它假设你想将当前的日期赋给变量你可以使用以下代码这行代码会执行命令并将命令的输出结果当前的日期和时间赋值给变量如果不使用会发生什么如果你省略就会把作为一个普通的字符串处理而不会执行它复制代码这时变量会被赋值为字符串而不是命令的输出结果另一种命令替换的方式反引号除了你还可以使用反引号来进行命令替换复制代码但是反引号有一些局限性嵌套命令时会变得非常难以读取例如里面包含反引号时就会变得很难维护使用更加现代和可读特别是对于复杂命令总结用于在脚本中执行命令并捕获其输出没有它就无法知道你要执行的命令并且会把它当作普通字符串处理方括号的使用方括号中使用表达式表达式需要与方括号之间有空格否则会错误',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-19 03:45:57',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">XBCID's BLOG</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HCIA/" style="font-size: 1.05rem;">HCIA<sup>9</sup></a><a href="/tags/HCIP/" style="font-size: 1.05rem;">HCIP<sup>6</sup></a><a href="/tags/Huawei/" style="font-size: 1.05rem;">Huawei<sup>15</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>18</sup></a><a href="/tags/openEuler/" style="font-size: 1.05rem;">openEuler<sup>18</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">May 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">23</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">March 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">February 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Linux/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Linux</span></a><a class="article-meta__tags" href="/tags/openEuler/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>openEuler</span></a><a class="article-meta__tags" href="/tags/Huawei/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Huawei</span></a><a class="article-meta__tags" href="/tags/HCIA/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>HCIA</span></a></span></div></div><h1 class="post-title" itemprop="name headline">08 使用shell脚本</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-05-18T19:46:45.683Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-05-18T19:45:57.835Z" title="更新于 2025-05-19 03:45:57">2025-05-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为重庆"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>重庆</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/"><header><a href="/tags/Linux/" tabindex="-1" itemprop="url">Linux</a><a href="/tags/openEuler/" tabindex="-1" itemprop="url">openEuler</a><a href="/tags/Huawei/" tabindex="-1" itemprop="url">Huawei</a><a href="/tags/HCIA/" tabindex="-1" itemprop="url">HCIA</a><h1 id="CrawlerTitle" itemprop="name headline">08 使用shell脚本</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">XBCID</span><time itemprop="dateCreated datePublished" datetime="2025-05-18T19:46:45.683Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time><time itemprop="dateCreated datePublished" datetime="2025-05-18T19:45:57.835Z" title="更新于 2025-05-19 03:45:57">2025-05-19</time></header><ul>
<li>本课程基于 openEuler</li>
<li>介绍关于 Shell 的基础知识</li>
<li>结合实际案例展示 Shell 脚本编写的最佳实践</li>
</ul>
<p>学完本课程后，您应该能：</p>
<ul>
<li>熟悉 Shell 基础知识</li>
<li>掌握 Shell 编程基础</li>
<li>能够编写常用的 Shell 脚本</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020719-4609642.png"></p>
<hr>
<h2 id="0x01-Shell基础介绍"><a href="#0x01-Shell基础介绍" class="headerlink" title="0x01 Shell基础介绍"></a>0x01 Shell基础介绍</h2><h3 id="1-1-openEuler构成Shell简介"><a href="#1-1-openEuler构成Shell简介" class="headerlink" title="1.1 openEuler构成Shell简介"></a>1.1 openEuler构成Shell简介</h3><ul>
<li>了解 Shell 在 openEuler 中的位置</li>
<li>掌握 Shell 脚本的基本操作</li>
</ul>
<hr>
<h4 id="1-1-1-Shell-概述"><a href="#1-1-1-Shell-概述" class="headerlink" title="1.1.1 Shell 概述"></a>1.1.1 Shell 概述</h4><ul>
<li>Shell 是系统的用户界面，提供了用户与内核进行交互操作的一种接口</li>
<li>Shell 将用户输入的命令并且把它们送到内核去执行，然后返回执行结果</li>
<li>Shell 是可编程的，它允许用户编写由 Shell 命令组成的程序</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020713-0211287.png"></li>
</ul>
<h4 id="1-1-2-Shell发展史"><a href="#1-1-2-Shell发展史" class="headerlink" title="1.1.2 Shell发展史"></a>1.1.2 Shell发展史</h4><p>1971 : Bell Labs 的 Ken Thompson 为 UNIX 开发了第一个 Shell: V6 Shell 是一个在内核之外执行的独立的用户程序<br>1977 ：Steven Bourne 在 AT&amp;T Bell Labs 为 V7 UNIX 创建 Bourne shell<br>1978 ：Bill Joy 在伯克利分校攻读研究生期间为 BSD UNIX 系统开发的 csh<br>1983 ： Ken Greer 在卡内基-梅隆大学开发了 tcsh，将 C Shell 引入了 Tenex 系统中的一些功能，如命令行编辑功能和文件名和命令自动补全功能<br>1983 ：David Korn 在 AT&amp;T Bell Labs 创建 korn shell，它功能更强大，提供关联数组表达式运算<br>1989 ：Bourne-Again Shell（或 Bash）是一个开源 GNU 项目，旨在取代 Bourne shell；Bash 由 Brian Fox 开发，已成为世上最流行的 Shell，它兼容 sh、csh、ksh，是 Linux 系统的默认 Shell</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020713-0643357.png"></p>
<p>在 Linux 中，有多种 Shell 程序可供选择，比如 dash、csh、zsh 等，默认的 Shell 可以在 &#x2F;bin&#x2F;sh 查看，在&#x2F;etc&#x2F;passwd 中修改。</p>
<h4 id="1-1-4-查看Shell"><a href="#1-1-4-查看Shell" class="headerlink" title="1.1.4 查看Shell"></a>1.1.4 查看Shell</h4><p>登陆 openEuler，查看系统默认安装的 Shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/shells</span><br></pre></td></tr></table></figure>

<p>查看当前登陆用户默认 Shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $SHELL</span><br></pre></td></tr></table></figure>

<p>查看当前的 Shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $0</span><br></pre></td></tr></table></figure>


<h3 id="1-2-Shell脚本（定义、作用、格式、权限及执行）"><a href="#1-2-Shell脚本（定义、作用、格式、权限及执行）" class="headerlink" title="1.2 Shell脚本（定义、作用、格式、权限及执行）"></a>1.2 Shell脚本（定义、作用、格式、权限及执行）</h3><h4 id="1-2-1-Shell脚本基础知识"><a href="#1-2-1-Shell脚本基础知识" class="headerlink" title="1.2.1 Shell脚本基础知识"></a>1.2.1 Shell脚本基础知识</h4><ul>
<li>在Unix&#x2F;Linux 里，一个程序&#x2F;命令只做好一件事</li>
<li>复杂的问题可以通过多个命令的组合来解决</li>
<li>形式最简单的 Shell 脚本就是一系列命令构成的可执行文件，并可以被其他脚本复用</li>
</ul>
<blockquote>
<p>编写风格良好易读的 Shell 脚本<br>可以提高日常任务的自动化程度和准确性</p>
</blockquote>
<h4 id="1-2-2-Shell脚本的约束"><a href="#1-2-2-Shell脚本的约束" class="headerlink" title="1.2.2 Shell脚本的约束"></a>1.2.2 Shell脚本的约束</h4><ul>
<li>没有“银弹<ul>
<li>Shell 脚本可以完成很多任务，但不适用于所有情况</li>
<li>对于可以通过调用其他命令行实用工具来完成的任务，Shell 脚本是一种不错的选择</li>
<li>Shell 脚本可以作为一种“胶水”语言，整合其他编程语言</li>
<li>银弹：没有一个工具可以解决所有问题</li>
</ul>
</li>
</ul>
<blockquote>
<p>当解决某个问题时，<br>Shell 脚本实现起来复杂度高，效率低，<br>此时就可以考虑使用其他编程语言。</p>
</blockquote>
<h4 id="1-2-3-Shell脚本开发环境"><a href="#1-2-3-Shell脚本开发环境" class="headerlink" title="1.2.3 Shell脚本开发环境"></a>1.2.3 Shell脚本开发环境</h4><ul>
<li>可以在任意文本编辑器中打开新文件来创建 Shell 脚本</li>
<li>高级编辑器如 Vim 和 Emacs，在识别文件的后缀为 .sh 后，可以提供语法高亮、检查、补全等功能<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# vim demo.sh #新建一个脚本文件，并写入如下内容：</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">echo &quot;Hello World“</span><br><span class="line">[root@openEuler ~]# sh demo.sh</span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="1-2-4-Shell脚本指定解释器"><a href="#1-2-4-Shell脚本指定解释器" class="headerlink" title="1.2.4 Shell脚本指定解释器"></a>1.2.4 Shell脚本指定解释器</h4><ul>
<li>Shell脚本只是静态的代码，若要输出结果，还需要解释器的参与</li>
<li>一般在脚本的第一行，指定执行此脚本的解释器</li>
<li>如果不指定解释器，脚本也能在默认的解释器中正常运行，但出于规范和安全的考虑，建议指定如下：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/csh</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="1-2-5-执行Shell脚本"><a href="#1-2-5-执行Shell脚本" class="headerlink" title="1.2.5 执行Shell脚本"></a>1.2.5 执行Shell脚本</h4><ul>
<li><p>对于脚本文件，我们有两种执行方式：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh scipt_name.sh</span><br><span class="line">./script_name.sh</span><br></pre></td></tr></table></figure></li>
<li><p>Linux中一切皆文件，脚本&#x2F;命令&#x2F;程序都是一个文件，文件作为一个对象，具有权限的属性</p>
</li>
<li><p>在执行别人发送或从网上下载的脚本时可能会遇到权限问题，赋予执行权限可解决</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x script_name.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果某个 Shell 脚本可执行，则可以通过在命令行中输入其名称调用</p>
<ul>
<li>如果某个 Shell 脚本可执行，则可以通过在命令行中输入其名称调用<ul>
<li>查看 <code>$PATH</code> 变量</li>
<li>修改 <code>$PATH</code> 变量</li>
<li>查找某个命令&#x2F;脚本的路径</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line">[root@openEuler ~]# PATH=$PATH:/New/path</span><br><span class="line">[root@openEuler ~]# echo $PATH</span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin:/New/path</span><br></pre></td></tr></table></figure>
<ul>
<li>永久修改<code>$PATH</code>需要在<code>.bashrc</code>或<code>.bash_profile</code>中添加<code>export PATH=&quot;$PATH:/new/path&quot;</code></li>
<li>关于变量的细节，后续章节还会提到</li>
</ul>
<h4 id="1-2-6-后台执行Shell脚本"><a href="#1-2-6-后台执行Shell脚本" class="headerlink" title="1.2.6 后台执行Shell脚本"></a>1.2.6 后台执行Shell脚本</h4><ul>
<li>有时候一些脚本执行时间较长，命令行界面会被占用，因此可以采取后台运行脚本<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./my_script.sh &amp;</span><br></pre></td></tr></table></figure></li>
<li>这种方法在退出Shell后，脚本进程会随之终止，为了保证脚本一直运行，可以采用：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup ./my_script.sh &amp;</span><br></pre></td></tr></table></figure>
脚本的标准输出和标准错误会重定向到nohup.out文件里</li>
<li>使用jobs命令可以查看后台中运行着的进程</li>
</ul>
<h2 id="0x02-Shell编程基础"><a href="#0x02-Shell编程基础" class="headerlink" title="0x02 Shell编程基础"></a>0x02 Shell编程基础</h2><ul>
<li>理解 Linux 中文本流的输入、输出以及重定向</li>
<li>掌握 Linux 中管道的用法</li>
<li>掌握 Shell 中的变量、运算符</li>
<li>掌握 Shell 中的逻辑判断、选择结构、循环结构</li>
</ul>
<hr>
<h3 id="2-1-输入输出、管道"><a href="#2-1-输入输出、管道" class="headerlink" title="2.1 输入输出、管道"></a>2.1 输入输出、管道</h3><h4 id="2-1-1-Linux中的文本流"><a href="#2-1-1-Linux中的文本流" class="headerlink" title="2.1.1 Linux中的文本流"></a>2.1.1 Linux中的文本流</h4><ul>
<li>文本流存在于Linux的每一个进程中</li>
<li>Linux的每个进程启动时，会打开三个文本流的端口：标准输入、标准输出、标准错误</li>
<li>这三个端口对应着一个程序的输入、输出和异常的抛出<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# date</span><br><span class="line">Wed Jul 29 10:39:17 CST 2020</span><br><span class="line">[root@openEuler ~]# datee</span><br><span class="line">bash: datee: command not found</span><br></pre></td></tr></table></figure>
<strong>例如：</strong><br>在 bash 中输入一串字符后，bash 进程中的标准输入端口捕获命令行中的输入，<br>进行处理后从标准输出端口中传出，回显在屏幕上，<br>如果处理过程中发生异常，则会通过标准错误端口，将异常回显在屏幕上。</li>
</ul>
<h4 id="2-1-2-输出重定向"><a href="#2-1-2-输出重定向" class="headerlink" title="2.1.2 输出重定向"></a>2.1.2 输出重定向</h4><ul>
<li>某些情况下，我们需要保存程序的输出，此时就可以通过重定向，将程序的输出保存到文件中</li>
</ul>
<ol>
<li>将标准输出定向到文件中：<ul>
<li><code>ls &gt; dir_log</code></li>
<li>使用这种方式会将程序的标准输出覆盖文件内容</li>
</ul>
</li>
<li>将标准输出追加到文件中：<ul>
<li><code>ls &gt;&gt; dir_log</code></li>
<li>使用这种方式会将标准输出追加至文件的末尾</li>
</ul>
</li>
<li>执行完命令后，可以通过<code>cat dir_log</code>查看保存的文件内容</li>
</ol>
<h4 id="2-1-3-输入重定向"><a href="#2-1-3-输入重定向" class="headerlink" title="2.1.3 输入重定向"></a>2.1.3 输入重定向</h4><ul>
<li>与输出重定向类似，输入重定向是把程序的标准输入进行重新定向</li>
<li>输入重定向：<ul>
<li>格式：<code>command &lt; inputfile</code></li>
<li>将右边的文件作为标准输入，然后传入左边的命令</li>
<li>例：<code>wc -l &lt; /dev/null</code></li>
</ul>
</li>
<li>内联输入重定向：<ul>
<li>格式：<code>command &lt;&lt; maker</code></li>
<li>输出重定向需要文件，而内联输入重定向可以使用即时输入的文本作为标准输入，传入左边的命令</li>
<li>右边的字符“maker”作为标志，表示标准输入的开始和结束，自身不包含在标准输入里。</li>
<li>右图例中以“EOF”作为标志</li>
</ul>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# less &lt;&lt; EOF</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">item 1</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">item 2</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">item 3</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">EOF</span></span><br><span class="line">item 1</span><br><span class="line">item 2</span><br><span class="line">item 3</span><br><span class="line">(END)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>command &lt;&lt; maker &gt;file</code></li>
</ul>
<h4 id="2-1-4-管道"><a href="#2-1-4-管道" class="headerlink" title="2.1.4 管道"></a>2.1.4 管道</h4><ul>
<li>有时需要将一个命令的输出连到另一个命令的输入，如果用重定向实现会较复杂</li>
<li>管道( | )就像现实中的水管一样，可以连接两个命令的输入和输出，甚至是串联多个命令</li>
<li>格式：<code>command1 | command2 | command3</code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~] ls /bin/ | grep python | less</span><br></pre></td></tr></table></figure></li>
<li>管道实际上是进程间通信（IPC）的一种方式</li>
</ul>
<h3 id="2-2-字符、变量、运算"><a href="#2-2-字符、变量、运算" class="headerlink" title="2.2 字符、变量、运算"></a>2.2 字符、变量、运算</h3><h4 id="2-2-1-Shell中的字符"><a href="#2-2-1-Shell中的字符" class="headerlink" title="2.2.1 Shell中的字符"></a>2.2.1 Shell中的字符</h4><p>和其他编程语言一样，Shell 也有一些保留字（特殊字符），在编写脚本时需要注意<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020719-5649485.png"></p>
<ul>
<li>注释符号(Hashmark<code>[Comments]</code>)<ul>
<li>在shell文件的行首，作为<a href="%E6%B3%A8%E9%87%8A/shebang.md">shebang</a>标记，<code>#!/bin/bash</code>;</li>
<li>其他地方作为注释作用，在一行中，#后面的内容并不会被执行，除非；</li>
<li>但是用单&#x2F;双引号包围时，<code>#</code>作为<code>#</code>号字符本身，不具有注释作用。</li>
</ul>
</li>
<li>单引号（full quoting <code>[single quote]</code>)<ul>
<li>单引号括住的内容，被视为单一字符串，引号内的禁止变量扩展，所有字符均作为字符本身处理（除单引号本身之外），单引号必须成对出现。</li>
</ul>
</li>
<li>反斜线，反斜杆(escape<code>[backslash]</code>)<ul>
<li>放在特殊符号之前，转义特殊符号的作用，仅表示特殊符号本身，这在字符串中常用；</li>
<li>放在一行指令的最末端，表示紧接着的回车无效（其实也就是转义了Enter），后继新行的输入仍然作为当前指令的一部分。</li>
</ul>
</li>
<li>斜线，斜杆（<code>Filename path separator [forward slash]</code>）<ul>
<li>作为路径的分隔符，路径中仅有一个斜杆表示根目录，以斜杆开头的路径表示从根目录开始的路径；</li>
<li>在作为运算符的时候，表示除法符号。如：a&#x3D;4&#x2F;2</li>
</ul>
</li>
<li>感叹号（<code>reverse (or negate) [bang],[exclamation mark]</code>)<ul>
<li>取反一个测试结果或退出状态</li>
<li>表示反逻辑，比如后面的!&#x3D;,这个是表示不等于；</li>
<li>表示取反，如：<code>ls a[!0-9]</code>#表示a后面不是紧接一个数字的文件；&#96;</li>
</ul>
</li>
</ul>
<h4 id="2-2-2-变量"><a href="#2-2-2-变量" class="headerlink" title="2.2.2 变量"></a>2.2.2 变量</h4><ul>
<li>任何语言都有变量这个要素</li>
<li>Shell与其他强类型的编程语言如：C，Java和C++等有很大不同，Shell中的变量是无类型的</li>
<li>通过一个变量，我们可以引用一块内存区域的值，变量名就是这块内存区域上贴的一个标签</li>
<li>变量赋值：<code>variable=value</code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# a=&#x27;Hello World&#x27;</span><br><span class="line">[root@openEuler ~]# echo a</span><br><span class="line">a</span><br><span class="line">[root@openEuler ~]# echo $a</span><br><span class="line">Hello World</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="2-2-2-1-变量的类型"><a href="#2-2-2-1-变量的类型" class="headerlink" title="2.2.2.1 变量的类型"></a>2.2.2.1 变量的类型</h5><ul>
<li><p>在 Linux Shell 中，变量主要有两大类：</p>
<ul>
<li>环境变量</li>
<li>用户定义变量</li>
</ul>
</li>
<li><p>每种类型的变量依据作用域不同，又分为全局变量和局部变量</p>
<ul>
<li>全局变量作用在整个Shell会话及其子Shell</li>
<li>局部变量作用在定义她们的进程及其子进程内</li>
</ul>
</li>
<li><p>查看变量</p>
<ul>
<li>使用<code>printenv</code>查看全局变量</li>
<li>使用<code>set</code>查看某个特定进程中的所有变量，包括局部变量、全局变量以及用户定义变量</li>
</ul>
</li>
<li><p>修改变量</p>
<ul>
<li>在.bash_profile或.bashrc中添加export语句，永久修改变量</li>
</ul>
</li>
<li><p>对比<code>printenv</code>与<code>set</code>的区别：<code>dif -yw &lt;(printenv)&lt;(set)</code></p>
</li>
<li><p>命令<code>set</code>是<code>Shell</code>中的一个内建命令，它能够显示当前<code>Shell</code>中的变量，以及用户自定义的变量，不管该变量有没有<code>export</code>。<code>set</code>命令允许你更改<code>Shell</code>选项的值并设置位置参数，或者显示<code>Shell</code>变量的名称和值。如果未提供任何选项或参数，则会设置显示所有<code>Shell</code>变量和函数的名称和值（按照当前语言环境排序），并且输出的格式可以重新用作设置或重置当前设置变量的输入</p>
</li>
<li><p><code>printenv</code>和<code>env</code>在环境变量打印方面是类似的。但是在功能上，<code>env</code>主要用于设置环境变量并运行指定的命令命令，而<code>printenv</code>是为了打印环境变量。</p>
</li>
<li><p>set则是一个Shell的内建命令，与Shell有关，用于设置Shell的属性。</p>
</li>
</ul>
<h5 id="2-2-2-2-使用变量-单、双引号"><a href="#2-2-2-2-使用变量-单、双引号" class="headerlink" title="2.2.2.2 使用变量(单、双引号)"></a>2.2.2.2 使用变量(单、双引号)</h5><ul>
<li>Shell变量命名规则：<ul>
<li>变量名由数字、字母、下划线组成</li>
<li>必须以字母或者下划线开头、</li>
<li>不能使用Shell里的关键字</li>
</ul>
</li>
<li>定义变量的格式：<ul>
<li>variable&#x3D;value</li>
<li>variable&#x3D;’value’</li>
<li>variable&#x3D;”value”</li>
</ul>
</li>
<li><strong>赋值号的周围不能有空格</strong></li>
<li>如果有必要，也可以使用 declare 关键字显式定义变量的类型</li>
<li>查询关键字：<code>help | grep &lt;keywords&gt;</code></li>
<li>如果<code>value</code>包含了空白符，则需要用引号包裹起来<ul>
<li>单引号包裹的内容，shell不展开命令、变量，即原样输出</li>
<li><strong>双引号反之，会展开其中包裹的命令和变量</strong></li>
</ul>
</li>
</ul>
<h5 id="2-2-2-3-扩展变量"><a href="#2-2-2-3-扩展变量" class="headerlink" title="2.2.2.3 扩展变量"></a>2.2.2.3 扩展变量</h5><ul>
<li>在以下示例中，如果不使用花括号，Bash会将<code>$FIRST_$LAST</code>解释为变量<code>$FIRST_</code>后跟变量<code>$LAST</code>，而不是由_字符分隔的变量<code>$FIRST</code>和<code>$LAST</code></li>
<li>因此，在此情况下，必须使用花括号引用的形式才能使变量扩展正确运行<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# FIRST_=Jane</span><br><span class="line">[root@openEuler ~]# FIRST=john</span><br><span class="line">[root@openEuler ~]# LAST=Doe</span><br><span class="line">[root@openEuler ~]# echo $FIRST_$LAST</span><br><span class="line">Doe</span><br><span class="line">[root@openEuler ~]# echo $&#123;FIRST&#125;_$LAST</span><br><span class="line">john_Doe</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="2-2-2-4-变量的赋值与输出"><a href="#2-2-2-4-变量的赋值与输出" class="headerlink" title="2.2.2.4 变量的赋值与输出"></a>2.2.2.4 变量的赋值与输出</h5><ul>
<li>定义并赋值如下变量，个人姓名name,日期date</li>
<li>输出姓名及日期变量</li>
<li>读取输入并输出</li>
<li><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name=Euler</span><br><span class="line">time=&#x27;20250208&#x27;</span><br><span class="line">echo &quot;My name is $name,today is $time&quot;</span><br><span class="line">read name</span><br><span class="line">echo &quot;Hello,$name,welcome&quot;</span><br></pre></td></tr></table></figure></li>
<li>read 命令，等待用户输入，随后将输入的内容赋给变量</li>
</ul>
<h4 id="2-2-3-Shell的算术扩展"><a href="#2-2-3-Shell的算术扩展" class="headerlink" title="2.2.3 Shell的算术扩展"></a>2.2.3 Shell的算术扩展</h4><ul>
<li>算术扩展可用于执行简单的整数算术运算</li>
<li>语法：<code>$[表达式]</code></li>
<li>例：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@openEuler ~]# echo $[1+1]</span><br><span class="line">2</span><br><span class="line">[root@openEuler ~]# echo $[2*2]</span><br><span class="line">4</span><br><span class="line">[root@openEuler ~]# COUNT=1; echo $[$[$COUNT+1]*2]</span><br><span class="line">4</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="2-2-3-1-在Shell中计算时间"><a href="#2-2-3-1-在Shell中计算时间" class="headerlink" title="2.2.3.1 在Shell中计算时间"></a>2.2.3.1 在Shell中计算时间</h5><ul>
<li>定义24小时，60分钟，60秒变量</li>
<li>定义每天秒数变量并赋值</li>
<li>输出变量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# SEC_PER_MIN=60</span><br><span class="line">[root@openEuler ~]# MIN_PER_HR=60</span><br><span class="line">[root@openEuler ~]# HR_PER_DAY=24</span><br><span class="line">[root@openEuler ~]# SEC_PER_DAY=$[ $SEC_PER_MIN * $MIN_PER_HR * $HR_PER_DAY ]</span><br><span class="line">[root@openEuler ~]# echo &quot;There are $SEC_PER_DAY seconds in a day&quot;</span><br><span class="line">There are 86400 seconds in a day</span><br></pre></td></tr></table></figure>

<h5 id="2-2-3-2-算术运算常用表达式"><a href="#2-2-3-2-算术运算常用表达式" class="headerlink" title="2.2.3.2 算术运算常用表达式"></a>2.2.3.2 算术运算常用表达式</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020813-0716787.png"></p>
<h6 id="2-2-3-2-1-算术运算的优先级"><a href="#2-2-3-2-1-算术运算的优先级" class="headerlink" title="2.2.3.2.1 算术运算的优先级"></a>2.2.3.2.1 算术运算的优先级</h6><p>优先级由高到低如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020814-1712460.png"></p>
<h6 id="2-2-3-2-2-变量递增的前置后置区别"><a href="#2-2-3-2-2-变量递增的前置后置区别" class="headerlink" title="2.2.3.2.2 变量递增的前置后置区别"></a>2.2.3.2.2 变量递增的前置后置区别</h6><p><code>echo $[++i]</code>和<code>echo $[i++]</code>输出是否一样？<br>在触发边界条件时有哪些场景需要注意？</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler ~]# i=3</span><br><span class="line">[root@openEuler ~]# echo $[i]</span><br><span class="line">3</span><br><span class="line">[root@openEuler ~]# echo $[++i]</span><br><span class="line">4</span><br><span class="line">[root@openEuler ~]# echo $[i++]</span><br><span class="line">4</span><br><span class="line">[root@openEuler ~]# echo $i</span><br><span class="line">5</span><br></pre></td></tr></table></figure>
<ul>
<li>i++ 要开辟一个变量来保存 i 的值 并返回，然后让 i 这个变量 的值 +1 。而 ++i 直接把 1 加到 i 这个 变量的空间中去，并返回这个空间 中的值， 没有开辟任何临时空间，性能更高</li>
<li>图中返回的变量是 i，所以有这样的差异</li>
</ul>
<h3 id="2-3-语句（条件，循环）"><a href="#2-3-语句（条件，循环）" class="headerlink" title="2.3 语句（条件，循环）"></a>2.3 语句（条件，循环）</h3><h4 id="2-3-1-Shell-中的结构化命令"><a href="#2-3-1-Shell-中的结构化命令" class="headerlink" title="2.3.1 Shell 中的结构化命令"></a>2.3.1 Shell 中的结构化命令</h4><ul>
<li>在 Shell 脚本里除了顺序执行，还需要一些额外的逻辑控制流程</li>
<li>和其他编程语言类似， Shell 中的结构化命令主要包括条件、循环两类</li>
</ul>
<h4 id="2-3-2-条件语句"><a href="#2-3-2-条件语句" class="headerlink" title="2.3.2 条件语句"></a>2.3.2 条件语句</h4><ul>
<li><code>if-then</code>语句</li>
<li>语法：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if command</span><br><span class="line">	then</span><br><span class="line">		commands</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></li>
<li>Bash Shell 会先执行 if 后面的语句，如果其退出状态码为 0，则会继续执行 then 部分的命令，否则会执行脚本中的下一个命令</li>
<li>Shell 中的 if 和其他 if 判断的条件不太一样，需注意</li>
</ul>
<h5 id="2-3-2-1-多分支判断语句"><a href="#2-3-2-1-多分支判断语句" class="headerlink" title="2.3.2.1 多分支判断语句"></a>2.3.2.1 多分支判断语句</h5><ul>
<li>在涉及多条件判断时，可能会使用较为繁琐的 if-then-else 语句，通过 elif 语句频繁检测同一个变量的值，此时更适合使用 case 语句</li>
<li>语法：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">case variable in</span><br><span class="line">pattern1 | pattern2) commands1;;</span><br><span class="line">pattern3) commands2;;</span><br><span class="line">*) default commands;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure></li>
<li>case 语句会将指定的变量与不同的模式比较，若匹配，则执行对应的命令</li>
<li>用 | 可以分割出多个模式</li>
<li>用 * 代表所有与已知模式不匹配的值</li>
</ul>
<h4 id="2-3-3-循环语句"><a href="#2-3-3-循环语句" class="headerlink" title="2.3.3 循环语句"></a>2.3.3 循环语句</h4><ul>
<li>Shell 脚本中常会遇到一些重复任务，相当于循环执行一组命令直到满足了某个特定条件</li>
<li>常见的循环语句有3种：<code>for</code>、<code>while</code>、<code>until</code></li>
<li>循环控制符有两种：<code>break</code>、<code>continue</code>用于控制循环流程的转向</li>
</ul>
<h5 id="2-3-3-1-for循环"><a href="#2-3-3-1-for循环" class="headerlink" title="2.3.3.1 for循环"></a>2.3.3.1 for循环</h5><p>语法（Shell风格）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">for var in list</span><br><span class="line">	do</span><br><span class="line">		commans</span><br><span class="line">	done</span><br><span class="line"></span><br><span class="line">e.g.</span><br><span class="line">for i in &#123;1..10&#125;</span><br><span class="line">	do</span><br><span class="line">		printf &quot;$i\n&quot;</span><br><span class="line">	done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>语法（C语言风格）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">for ((var assignment ; condition ; iteration process))</span><br><span class="line">do</span><br><span class="line">commands</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">for (( i = 1; i &lt; 10 ; i++))</span><br><span class="line">do</span><br><span class="line">echo “Hello”</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>do和done之间的命令称为循环体，执行次数和list列表中常数或字符串的个数相同。for循环，首先将in后list列表的第一个常数或字符串赋值给循环变量，然后执行循环体，以此执行list，最后执行done命令后的命令序列。</p>
<h5 id="2-3-3-2-for循环中的列表"><a href="#2-3-3-2-for循环中的列表" class="headerlink" title="2.3.3.2 for循环中的列表"></a>2.3.3.2 for循环中的列表</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@openeuler ~]# for HOST in host1 host2 host3; do echo $HOST; done</span><br><span class="line">host1</span><br><span class="line">host2</span><br><span class="line">host3</span><br><span class="line"></span><br><span class="line">[root@openeuler ~]# for HOST in host&#123;1..3&#125;; do echo $HOST; done</span><br><span class="line">host1</span><br><span class="line">host2</span><br><span class="line">host3</span><br><span class="line">[root@openeuler ~]# for EVEN in $(seq 2 2 8); do echo &quot;$EVEN&quot;; done;</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h5 id="2-3-3-3-for循环奇数累加器"><a href="#2-3-3-3-for循环奇数累加器" class="headerlink" title="2.3.3.3 for循环奇数累加器"></a>2.3.3.3 for循环奇数累加器</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">sum=0</span><br><span class="line">for i in &#123;1..100..2&#125;</span><br><span class="line">do </span><br><span class="line">	let &quot;sum+=i&quot;</span><br><span class="line">done</span><br><span class="line">echo &quot;sum=$sum&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-3-3-4-for循环文件展示"><a href="#2-3-3-4-for循环文件展示" class="headerlink" title="2.3.3.4 for循环文件展示"></a>2.3.3.4 for循环文件展示</h5><ul>
<li>展示目录下所有文件</li>
<li>参考脚本：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">for file in $(ls)</span><br><span class="line">do</span><br><span class="line">	ehco &quot;file:$file&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="2-3-3-5-while循环"><a href="#2-3-3-5-while循环" class="headerlink" title="2.3.3.5 while循环"></a>2.3.3.5 while循环</h5><ul>
<li>也称为前测试循环语句，重复次数是利用一个条件来控制是否继续重复执行这个语句</li>
<li>为避免死循环，必须保证循环体中包含循环出口条件<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin./bash</span></span><br><span class="line"></span><br><span class="line">sum=0;i=1</span><br><span class="line">while(i&lt;=100)</span><br><span class="line">do</span><br><span class="line">	let &quot;sum+=i&quot;</span><br><span class="line">	let &quot;i+=2&quot;</span><br><span class="line">done</span><br><span class="line">	echo &quot;sum=$sum&quot;</span><br></pre></td></tr></table></figure>
此处示例等同于此前奇数累加器，思考：与for循环实现方式相比有何不同?</li>
</ul>
<h5 id="2-3-3-6-until循环"><a href="#2-3-3-6-until循环" class="headerlink" title="2.3.3.6 until循环"></a>2.3.3.6 until循环</h5><p>与 while 循环类似，但是跳出循环的条件判断有所区别</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">奇数累加器</span></span><br><span class="line">sum=0;i=1</span><br><span class="line">until(( i &gt; 100 ))</span><br><span class="line">do</span><br><span class="line">let &quot;sum+=i&quot;</span><br><span class="line">let &quot;i += 2&quot;</span><br><span class="line">done</span><br><span class="line">echo &quot;sum=$sum&quot;</span><br></pre></td></tr></table></figure>
<p>此处示例脚本等同于此前奇数累加器<br>思考：与for循环,while循环实现方式相比有何不同？</p>
<h5 id="2-3-3-7-使用循环打印乘法表"><a href="#2-3-3-7-使用循环打印乘法表" class="headerlink" title="2.3.3.7 使用循环打印乘法表"></a>2.3.3.7 使用循环打印乘法表</h5><p>P440</p>
<p>参考脚本“</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">for (i=1;i&lt;=9;i++)do</span><br><span class="line">	for(j=1;j&lt;=9;j++)do</span><br><span class="line">		let &quot;temp=i*j&quot;</span><br><span class="line">		echo -n &quot;$i*$j=$temp&quot;</span><br><span class="line">		echo &quot;\t&quot;</span><br><span class="line">		done</span><br><span class="line">printf &quot;\n&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>


<h2 id="0x03-Shell编程最佳实践"><a href="#0x03-Shell编程最佳实践" class="headerlink" title="0x03 Shell编程最佳实践"></a>0x03 Shell编程最佳实践</h2><ul>
<li>掌握 bash 的调试模式</li>
<li>掌握 Shell 脚本的基本调试方法</li>
<li>了解 Shell 脚本编写过程中应遵循的良好风格</li>
<li>掌握常见脚本的编写方法</li>
</ul>
<hr>
<h3 id="3-1-调试"><a href="#3-1-调试" class="headerlink" title="3.1 调试"></a>3.1 调试</h3><h4 id="3-1-1-Shell-脚本错误故障排除"><a href="#3-1-1-Shell-脚本错误故障排除" class="headerlink" title="3.1.1 Shell 脚本错误故障排除"></a>3.1.1 Shell 脚本错误故障排除</h4><ul>
<li>编写、使用或维护 Shell 脚本的管理员不可避免地会遇到脚本的错误<ul>
<li>错误通常是由于输入错误、语法错误或脚本逻辑不佳导致</li>
<li>在编写脚本时,将文本编辑器与 bash 语法高亮显示结合使用可以帮助使错误更明显</li>
<li>找到并排除脚本中错误的最直接方法是调试</li>
<li>避免在脚本中引入错误的另一种简单方法是在创建脚本期间遵循良好风格</li>
</ul>
</li>
</ul>
<h4 id="3-1-2-调试模式"><a href="#3-1-2-调试模式" class="headerlink" title="3.1.2 调试模式"></a>3.1.2 调试模式</h4><ul>
<li><p>脚本上激活调试模式，请向脚本第一行中的命令解释器中添加<code>-x</code>选项</p>
</li>
<li><p>如此前乘法表，进行如下修改：<br><code>#!/bin/bash -x</code></p>
</li>
<li><p>bash 的调试模式将打印出脚本执行前由脚本执行的命令</p>
</li>
<li><p>已执行的所有 shell 扩展的结果都将显示在打印输出中，所有变量数据状态会实时打印，以供跟踪：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler tmp]# bash -x adder.sh</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020817-3530742.png"></p>
<h4 id="3-1-3-评估退出代码"><a href="#3-1-3-评估退出代码" class="headerlink" title="3.1.3 评估退出代码"></a>3.1.3 评估退出代码</h4><ul>
<li><p>每个命令返回一个退出状态，也通常称为返回状态或退出代码</p>
</li>
<li><p>退出代码可以用于脚本的调试</p>
</li>
<li><p>以下示例说明了几个常用命令的执行和退出状态检索</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@openEuler tmp]# ls /etc/hosts</span><br><span class="line">/etc/hosts</span><br><span class="line">[root@openEuler tmp]# echo $?</span><br><span class="line">0</span><br><span class="line">----------------------------------------------------------------</span><br><span class="line">[root@openEuler tmp]# ls /etc/nofile</span><br><span class="line">ls: cannot access /etc/nofile: No such file or directory</span><br><span class="line">[root@openEuler tmp]# echo $?</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
</li>
<li><p>在脚本中使用退出代码</p>
</li>
<li><p>一旦执行，脚本将在其处理所有内容之后退出，但是有时候可能需要中途退出脚本，比如在遇到错误条件时</p>
</li>
<li><p>可以通过在脚本中使用 exit 命令来实现这一目的，当脚本遇到 exit 命令时，脚本将立即退出并跳过对脚本其余内容的处理</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">echo &quot;Hello World&quot;</span><br><span class="line">exit 1</span><br><span class="line"></span><br><span class="line">[root@openEuler tmp]# ./hello.sh</span><br><span class="line">Hello World</span><br><span class="line">[root@openEuler tmp]# echo $?</span><br><span class="line">1</span><br></pre></td></tr></table></figure>


<h3 id="3-2-语法风格"><a href="#3-2-语法风格" class="headerlink" title="3.2 语法风格"></a>3.2 语法风格</h3><h4 id="3-2-1-良好风格"><a href="#3-2-1-良好风格" class="headerlink" title="3.2.1 良好风格"></a>3.2.1 良好风格</h4><ul>
<li>以下是要遵循的一些具体做法:<ul>
<li>将长命令分解为多行更小的代码块，代码段越短，就越便于读者领悟和理解</li>
<li>将多个语句的开头和结尾排好，以便于查看控制结构的开始和结束位置以及它们是否正确关闭</li>
<li>对包含多行语句的行进行缩进，以表示代码逻辑的层次结构和控制结构的流程</li>
<li>使用行间距分隔命令块以阐明一个代码段何时结束以及另一个代码段何时开始</li>
<li>在整个脚本中通篇使用一致的格式</li>
</ul>
</li>
<li>添加注释和空格如何能够极大改善脚本可读</li>
<li>利用这些简单做法，极大方便了用户在编写期间发现错误，还提高了脚本对于将来读者的可读性<br>脚本示例：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">for PACKAGE in $(rpm -qa | grep kernel); do echo &quot;$PACKAGE was installed on $(date -d @$(rpm -q --qf &quot;%&#123;INSTALLTIME&#125;\n&quot; $PACKAGE))&quot;; done</span><br></pre></td></tr></table></figure>
修改后的脚本<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">此脚本是读取关于kernel相关的软件包信息，并从RPM数据库中查询软件包的安装时间</span></span><br><span class="line">PACKAGETYPE=kernel</span><br><span class="line">PACKAGES=$(rpm -qa | grep $PACKAGETYPE)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">循环处理信息</span></span><br><span class="line">for PACKAGE in $PACKAGES; do</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">查询每个软件包的安装时间</span></span><br><span class="line">INSTALLEPOCH=$(rpm -q --qf &quot;%&#123;INSTALLTIME&#125;\n&quot; $PACKAGE)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">把时间转换为普通的日期时间</span></span><br><span class="line">INSTALLDATETIME=$(date -d @$INSTALLEPOCH)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">打印信息</span></span><br><span class="line">echo &quot;$PACKAGE was installed on $INSTALLDATETIME&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-3-最佳实践范例"><a href="#3-3-最佳实践范例" class="headerlink" title="3.3 最佳实践范例"></a>3.3 最佳实践范例</h3><h4 id="3-3-1-监测日志告警信息并邮件通知"><a href="#3-3-1-监测日志告警信息并邮件通知" class="headerlink" title="3.3.1 监测日志告警信息并邮件通知"></a>3.3.1 监测日志告警信息并邮件通知</h4><ul>
<li><p>场景描述：</p>
<ul>
<li>某运营商要求对当前环境日志文件“error.log”进行长期监测，如发现关键词“danger”，则发送告警邮件</li>
</ul>
</li>
<li><p>要求：</p>
<ul>
<li>日志文件可自己新建，用脚本模拟写入</li>
<li>发送邮件可通过mail指令，但受限实验环境，可通过向日志文件写入”mail”字符串来替代</li>
<li>实现效果：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/2025020822-1035999.png"></li>
</ul>
</li>
<li><p>后台运行监测脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test.sh &amp;</span><br></pre></td></tr></table></figure></li>
<li><p>模拟报错：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./addlog.sh</span><br></pre></td></tr></table></figure></li>
<li><p>查看<code>error.log</code>文件，检查结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/error.log</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">日志检测脚本test.sh</span></span><br><span class="line"></span><br><span class="line">tail -f /var/log/error.log | while read danger;</span><br><span class="line">do echo &#x27;mail&#x27; &gt;&gt; /var/log/error.log</span><br><span class="line">sleep 1m;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">模拟报错脚本addlog.sh</span></span><br><span class="line">echo &#x27;danger&#x27; &gt;&gt; /var/log/error.log</span><br></pre></td></tr></table></figure>

<h2 id="0x04-本章总结"><a href="#0x04-本章总结" class="headerlink" title="0x04 本章总结"></a>0x04 本章总结</h2><ul>
<li>本章系统介绍了 Shell 脚本中的各个要素，包括执行、编写、调试</li>
<li>在执行部分，介绍了工作中常用的前台、后台运行方式及对应操作</li>
<li>在编写部分，介绍了编写 Shell 脚本所需的变量、语句结构等知识</li>
<li>在调试部分，介绍了常见的调试方法和编写过程中良好风格</li>
<li>本章提供了大量的实际案例和示例代码，有助于实际工作中的使用</li>
</ul>
<h2 id="0x05-Shell脚本的一些注意点"><a href="#0x05-Shell脚本的一些注意点" class="headerlink" title="0x05 Shell脚本的一些注意点"></a>0x05 Shell脚本的一些注意点</h2><ul>
<li>在 Bash 中，变量赋值时，等号两边不能有空格。</li>
<li>在 Bash 中，<code>$()</code> 是用于命令替换的语法。它允许你将命令的输出结果作为表达式的一部分，并将其赋值给一个变量，或者在其他命令中使用。</li>
</ul>
<h3 id="为什么需要使用-？"><a href="#为什么需要使用-？" class="headerlink" title="为什么需要使用 $()？"></a>为什么需要使用 <code>$()</code>？</h3><ol>
<li><p><strong>获取命令输出</strong>： <code>$()</code> 用于获取命令的输出并将其替换到变量或其他表达式中。换句话说，<code>$()</code> 是一种将命令的标准输出嵌入到其他命令或赋值中的方式。</p>
</li>
<li><p><strong>防止语法错误</strong>： 如果没有 <code>$()</code> 或者反引号  ，Bash 会将整个命令当作普通的字符串处理，而不是执行它。</p>
</li>
</ol>
<p>假设你想将当前的日期赋给变量 <code>day_of_week</code>，你可以使用以下代码：</p>
<p><code>day_of_week=$(date)</code></p>
<p>这行代码会执行 <code>date</code> 命令，并将 <code>date</code> 命令的输出结果（当前的日期和时间）赋值给变量 <code>day_of_week</code>。</p>
<p>如果不使用 <code>$()</code> 会发生什么？</p>
<p>如果你省略 <code>$()</code>，Bash 就会把 <code>date</code> 作为一个普通的字符串处理，而不会执行它：</p>
<p>bash复制代码</p>
<p><code>day_of_week=date</code></p>
<p>这时，变量 <code>day_of_week</code> 会被赋值为字符串 <code>&quot;date&quot;</code>，而不是 <code>date</code> 命令的输出结果。</p>
<h3 id="另一种命令替换的方式：反引号（-）"><a href="#另一种命令替换的方式：反引号（-）" class="headerlink" title="另一种命令替换的方式：反引号（````）"></a>另一种命令替换的方式：反引号<code>（````）</code></h3><p>除了 <code>$()</code>，你还可以使用反引号来进行命令替换：</p>
<p>bash复制代码</p>
<p><code>day_of_week=`date`</code></p>
<p>但是，反引号有一些局限性：</p>
<ul>
<li>嵌套命令时会变得非常难以读取。例如，<code>date +%Y-%m-%d</code> 里面包含反引号时就会变得很难维护。</li>
<li>使用 <code>$()</code> 更加现代和可读，特别是对于复杂命令。</li>
</ul>
<p>总结：</p>
<p><code>$()</code> 用于在 Bash 脚本中执行命令并<strong>捕获其输出</strong>。没有它，Bash 就无法知道你要执行的命令，并且会把它当作普通字符串处理。</p>
<h3 id="方括号的使用"><a href="#方括号的使用" class="headerlink" title="方括号的使用"></a>方括号的使用</h3><p>方括号中使用表达式 表达式需要与方括号之间有空格 否则会错误</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">XBCID</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/')">08 使用shell脚本</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=08 使用shell脚本&amp;url=http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">XBCID's BLOG</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Linux/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Linux<span class="tagsPageCount">18</span></a><a class="post-meta__box__tags" href="/tags/openEuler/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>openEuler<span class="tagsPageCount">18</span></a><a class="post-meta__box__tags" href="/tags/Huawei/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Huawei<span class="tagsPageCount">15</span></a><a class="post-meta__box__tags" href="/tags/HCIA/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>HCIA<span class="tagsPageCount">9</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/06%20%E7%AE%A1%E7%90%86%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%8F%8A%E5%AD%98%E5%82%A8/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">06 管理文件系统及存储</div></div></a></div><div class="next-post pull-right"><a href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/09%20Samba%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">09 Samba文件共享服务器管理</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IA/01%20openEuler%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8/" title="01 openEuler操作系统入门"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">01 openEuler操作系统入门</div></div></a></div><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IA/02%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C%E5%9F%BA%E7%A1%80/" title="02 命令行操作基础"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">02 命令行操作基础</div></div></a></div><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IA/03%20%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%A5%E5%8F%8A%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/" title="03 文本编辑器以及文本处理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">03 文本编辑器以及文本处理</div></div></a></div><div><a href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/06%20%E7%AE%A1%E7%90%86%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%8F%8A%E5%AD%98%E5%82%A8/" title="06 管理文件系统及存储"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-19</div><div class="title">06 管理文件系统及存储</div></div></a></div><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IA/04%20%E7%94%A8%E6%88%B7%E5%92%8C%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" title="04 用户和权限管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">04 用户和权限管理</div></div></a></div><div><a href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/05%20%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%B9%B6%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1/" title="05 安装软件并管理服务"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-19</div><div class="title">05 安装软件并管理服务</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-Shell%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">0x01 Shell基础介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-openEuler%E6%9E%84%E6%88%90Shell%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 openEuler构成Shell简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-Shell-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 Shell 概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-Shell%E5%8F%91%E5%B1%95%E5%8F%B2"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 Shell发展史</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-4-%E6%9F%A5%E7%9C%8BShell"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.4 查看Shell</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Shell%E8%84%9A%E6%9C%AC%EF%BC%88%E5%AE%9A%E4%B9%89%E3%80%81%E4%BD%9C%E7%94%A8%E3%80%81%E6%A0%BC%E5%BC%8F%E3%80%81%E6%9D%83%E9%99%90%E5%8F%8A%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 Shell脚本（定义、作用、格式、权限及执行）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-Shell%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.2.1 Shell脚本基础知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2.2 Shell脚本的约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-3-Shell%E8%84%9A%E6%9C%AC%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.2.3 Shell脚本开发环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-4-Shell%E8%84%9A%E6%9C%AC%E6%8C%87%E5%AE%9A%E8%A7%A3%E9%87%8A%E5%99%A8"><span class="toc-number">1.2.4.</span> <span class="toc-text">1.2.4 Shell脚本指定解释器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-5-%E6%89%A7%E8%A1%8CShell%E8%84%9A%E6%9C%AC"><span class="toc-number">1.2.5.</span> <span class="toc-text">1.2.5 执行Shell脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-6-%E5%90%8E%E5%8F%B0%E6%89%A7%E8%A1%8CShell%E8%84%9A%E6%9C%AC"><span class="toc-number">1.2.6.</span> <span class="toc-text">1.2.6 后台执行Shell脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-Shell%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80"><span class="toc-number">2.</span> <span class="toc-text">0x02 Shell编程基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E3%80%81%E7%AE%A1%E9%81%93"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 输入输出、管道</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-Linux%E4%B8%AD%E7%9A%84%E6%96%87%E6%9C%AC%E6%B5%81"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 Linux中的文本流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 输出重定向</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-3-%E8%BE%93%E5%85%A5%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 输入重定向</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-%E7%AE%A1%E9%81%93"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4 管道</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%AD%97%E7%AC%A6%E3%80%81%E5%8F%98%E9%87%8F%E3%80%81%E8%BF%90%E7%AE%97"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 字符、变量、运算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-Shell%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 Shell中的字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E5%8F%98%E9%87%8F"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 变量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-1-%E5%8F%98%E9%87%8F%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">2.2.2.1 变量的类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-2-%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F-%E5%8D%95%E3%80%81%E5%8F%8C%E5%BC%95%E5%8F%B7"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">2.2.2.2 使用变量(单、双引号)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-3-%E6%89%A9%E5%B1%95%E5%8F%98%E9%87%8F"><span class="toc-number">2.2.2.3.</span> <span class="toc-text">2.2.2.3 扩展变量</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-4-%E5%8F%98%E9%87%8F%E7%9A%84%E8%B5%8B%E5%80%BC%E4%B8%8E%E8%BE%93%E5%87%BA"><span class="toc-number">2.2.2.4.</span> <span class="toc-text">2.2.2.4 变量的赋值与输出</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-Shell%E7%9A%84%E7%AE%97%E6%9C%AF%E6%89%A9%E5%B1%95"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2.3 Shell的算术扩展</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-3-1-%E5%9C%A8Shell%E4%B8%AD%E8%AE%A1%E7%AE%97%E6%97%B6%E9%97%B4"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">2.2.3.1 在Shell中计算时间</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-3-2-%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E5%B8%B8%E7%94%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.2.3.2.</span> <span class="toc-text">2.2.3.2 算术运算常用表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#2-2-3-2-1-%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">2.2.3.2.1.</span> <span class="toc-text">2.2.3.2.1 算术运算的优先级</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-2-3-2-2-%E5%8F%98%E9%87%8F%E9%80%92%E5%A2%9E%E7%9A%84%E5%89%8D%E7%BD%AE%E5%90%8E%E7%BD%AE%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.3.2.2.</span> <span class="toc-text">2.2.3.2.2 变量递增的前置后置区别</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%AF%AD%E5%8F%A5%EF%BC%88%E6%9D%A1%E4%BB%B6%EF%BC%8C%E5%BE%AA%E7%8E%AF%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 语句（条件，循环）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-Shell-%E4%B8%AD%E7%9A%84%E7%BB%93%E6%9E%84%E5%8C%96%E5%91%BD%E4%BB%A4"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 Shell 中的结构化命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 条件语句</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-2-1-%E5%A4%9A%E5%88%86%E6%94%AF%E5%88%A4%E6%96%AD%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">2.3.2.1 多分支判断语句</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.3.3.</span> <span class="toc-text">2.3.3 循环语句</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-1-for%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.3.3.1.</span> <span class="toc-text">2.3.3.1 for循环</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-2-for%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84%E5%88%97%E8%A1%A8"><span class="toc-number">2.3.3.2.</span> <span class="toc-text">2.3.3.2 for循环中的列表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-3-for%E5%BE%AA%E7%8E%AF%E5%A5%87%E6%95%B0%E7%B4%AF%E5%8A%A0%E5%99%A8"><span class="toc-number">2.3.3.3.</span> <span class="toc-text">2.3.3.3 for循环奇数累加器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-4-for%E5%BE%AA%E7%8E%AF%E6%96%87%E4%BB%B6%E5%B1%95%E7%A4%BA"><span class="toc-number">2.3.3.4.</span> <span class="toc-text">2.3.3.4 for循环文件展示</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-5-while%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.3.3.5.</span> <span class="toc-text">2.3.3.5 while循环</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-6-until%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.3.3.6.</span> <span class="toc-text">2.3.3.6 until循环</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-3-7-%E4%BD%BF%E7%94%A8%E5%BE%AA%E7%8E%AF%E6%89%93%E5%8D%B0%E4%B9%98%E6%B3%95%E8%A1%A8"><span class="toc-number">2.3.3.7.</span> <span class="toc-text">2.3.3.7 使用循环打印乘法表</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-Shell%E7%BC%96%E7%A8%8B%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">3.</span> <span class="toc-text">0x03 Shell编程最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E8%B0%83%E8%AF%95"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 调试</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-Shell-%E8%84%9A%E6%9C%AC%E9%94%99%E8%AF%AF%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 Shell 脚本错误故障排除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E8%B0%83%E8%AF%95%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2 调试模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E8%AF%84%E4%BC%B0%E9%80%80%E5%87%BA%E4%BB%A3%E7%A0%81"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3 评估退出代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%AF%AD%E6%B3%95%E9%A3%8E%E6%A0%BC"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 语法风格</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E8%89%AF%E5%A5%BD%E9%A3%8E%E6%A0%BC"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 良好风格</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E8%8C%83%E4%BE%8B"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 最佳实践范例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E7%9B%91%E6%B5%8B%E6%97%A5%E5%BF%97%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF%E5%B9%B6%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1 监测日志告警信息并邮件通知</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E6%9C%AC%E7%AB%A0%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">0x04 本章总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-number">5.</span> <span class="toc-text">0x05 Shell脚本的一些注意点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8-%EF%BC%9F"><span class="toc-number">5.1.</span> <span class="toc-text">为什么需要使用 $()？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A6%E4%B8%80%E7%A7%8D%E5%91%BD%E4%BB%A4%E6%9B%BF%E6%8D%A2%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%9A%E5%8F%8D%E5%BC%95%E5%8F%B7%EF%BC%88-%EF%BC%89"><span class="toc-number">5.2.</span> <span class="toc-text">另一种命令替换的方式：反引号（&#96;&#96;&#96;&#96;）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%8B%AC%E5%8F%B7%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">5.3.</span> <span class="toc-text">方括号的使用</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/07%20openEuler%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%85%A5%E9%97%A8/" title="无题">无题</a><time datetime="2025-05-18T19:46:45.900Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/%E6%B3%A8%E9%87%8A/shebang/" title="无题">无题</a><time datetime="2025-05-18T19:46:45.880Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/10%20%E5%B8%B8%E7%94%A8%E5%B0%8F%E6%8C%87%E4%BB%A4/" title="无题">无题</a><time datetime="2025-05-18T19:46:45.685Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/09%20Samba%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86/" title="09 Samba文件共享服务器管理">09 Samba文件共享服务器管理</a><time datetime="2025-05-18T19:46:45.684Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/" title="08 使用shell脚本">08 使用shell脚本</a><time datetime="2025-05-18T19:46:45.683Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="XBCID" target="_blank">XBCID</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">37</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HCIA/" style="font-size: 0.88rem;">HCIA<sup>9</sup></a><a href="/tags/HCIP/" style="font-size: 0.88rem;">HCIP<sup>6</sup></a><a href="/tags/Huawei/" style="font-size: 0.88rem;">Huawei<sup>15</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>18</sup></a><a href="/tags/openEuler/" style="font-size: 0.88rem;">openEuler<sup>18</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("01/12/2021 14:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 XBCID 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>