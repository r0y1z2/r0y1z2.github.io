<!DOCTYPE html><html lang="zh" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>03 openEuler存储管理 | XBCID's BLOG</title><meta name="keywords" content="Linux,openEuler,Huawei,HCIP"><meta name="author" content="XBCID"><meta name="copyright" content="XBCID"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="03 openEuler存储管理"><meta name="application-name" content="03 openEuler存储管理"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="03 openEuler存储管理"><meta property="og:url" content="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/index.html"><meta property="og:site_name" content="XBCID's BLOG"><meta property="og:description" content="存储是计算机系统中非常重要的概念，它负责存储和管理数据。随着IT技术的不断发展和企业对存储需求的不断变化，存储技术和架构也在不断革新。本章我们将从存储的基本概念开始了解不同存储类型的区别及使用方法。 学完本课程后，您将能够:  了解存储的基本概念和类型 掌握NAS的基本原理和使用方法 掌握SAN的不"><meta property="og:locale" content="zh"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="XBCID"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="存储是计算机系统中非常重要的概念，它负责存储和管理数据。随着IT技术的不断发展和企业对存储需求的不断变化，存储技术和架构也在不断革新。本章我们将从存储的基本概念开始了解不同存储类型的区别及使用方法。 学完本课程后，您将能够:  了解存储的基本概念和类型 掌握NAS的基本原理和使用方法 掌握SAN的不"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: XBCID","link":"链接: ","source":"来源: XBCID's BLOG","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'XBCID's BLOG',
  title: '03 openEuler存储管理',
  postAI: '',
  pageFillDescription: '0x01 存储的基本概念, 1. 什么是数据, 2. 什么是信息, 3. 存储介绍, 3.1 存储基本介绍, 3.2 存储架构的演进, 0x02 存储的分类, 2.1 存储分类 - 使用方式, 2.2 存储分类 - 数据存储方式, 2.3 存储分类 - 存储介质存放位置, 0x03 共享存储介绍, 3.1 NAS, 3.1.1 NAS简介, 3.1.2 NAS架构, 3.1.3 NAS常见协议, 3.1.4 NAS的特点, 3.1.5 NAS的使用场景, 3.2 NFS, 3.2.1 NFS简介, 3.2.2 NFS服务所需软件, 3.2.3 NFS工作机制, 3.2.4 NFS服务器安装, 3.2.5 NFS服务器配置, 3.2.6 NFS客户端配置, 3.3 存储区域网络SAN, 3.3.1 SAN简介, 3.3.2 iSCSI, 3.3.2.1 iSCSI简介, 3.3.2.2 iSCSI的基本组成, 3.3.2.3 IQN简介, 3.3.3 基于Linux的SAN配置流程, 3.3.3.1 Target配置方法, 3.3.3.1.1 Tgtadm简介, 3.3.3.1.2 Tgtadm常用参数, 3.3.3.1.3 Target永久配置 - 编辑配置文件, 3.3.3.2 Target配置案例, 0x04 分布式存储介绍, 4.1 常见的分布式存储架构, 4.2 GlusterFS的优点, 4.3 GlusterFS分布式存储功能特点, 4.4 GlusterFS架构, 4.4 GlusterFS常见卷模式介绍, 4.4.1 分布式卷 Distributed Glusterfs Volume, 4.4.2 复制卷 Replicated Glusterfs Volume, 4.4.3 分布式复制卷 Distributed Replicated Glusterfs Volume, 4.4.4 分散卷 Dispersed Glusterfs Volume, 4.4.5 分布式分散卷Distributed Dispersed Glusterfs Volume, 4.5 安装部署GlusterFS, 4.5.1 流程, 4.5.2 格式化和挂载bricks, 4.5.3 卷创建, 4.5.4 配置防火墙及trusted pool, 4.5.5 卷挂载, 4.5.6 部署Gluster客户端, 4.6 GlusterFS卷管理, 4.6.1 启用、停止、查看和再平衡, 4.6.2 删除卷, 4.6.3 扩容和缩容, 4.6.3 替换损坏的brick, 0x05 缩略语存储是计算机系统中非常重要的概念它负责存储和管理数据随着技术的不断发展和企业对存储需求的不断变化存储技术和架构也在不断革新本章我们将从存储的基本概念开始了解不同存储类型的区别及使用方法学完本课程后您将能够了解存储的基本概念和类型掌握的基本原理和使用方法掌握的不同类型及使用场景掌握的基本原理及常见卷模式存储的基本概念什么是数据全球网络存储工业协会对数数据的定义数据是对所有事物的数字表示数据是指描述客观事物的符号记录是未经加工的原始材料一组数字一段文字一张图片等都可以视为数据在计算机的世界里只有和所有要保存在计算机中需要读写的数据都可以用一串由和组成的数字表示什么是信息信息是已经被处理具有逻辑关系的数据是对数据的解释信息是经过处理的数据其中包括具有上下文相关性和目的的数据信息是指从数据中提取出来的有用的知识或意义数据冗余就是无用或无意义的内容存储介绍存储基本介绍数据文件信息需要通过电子设备进行存储这就是数据存储简称存储名词存储是指计算机系统中用户保存数据和信息的介质它可以是硬件设备如硬盘固态硬盘盘等也可以是软件系统如云存储和数据库等动词存储是将数据或信息保存在一个物理设备中的过程如硬盘闪存内存等这些设备可以长期保存信息即使电脑关闭或断电数据也不会丢失存储可以分为内部存储和外部存储内部存储通常指计算机内部的存储器例如硬盘固态硬盘内存等而外部存储则指通过外部设备进行数据存储例如外置硬盘光盘等存储的基本载体硬盘原始的存储方法也包括纸质存储和磁带存储等根据存储介质分类硬盘存储固态硬盘存储光盘存储磁带存储云存储存储架构的演进最早的存储设备为打孔纸带等计算机服务器普及开始内部硬盘是存储架构演进的初始单存储时代硬盘作为服务器内置存储由于主机内部空间导致磁盘容量受限影响性能提升直连存储技术出现早期企业数据规模不大存储需求简单外部数据存储设备直接挂在服务器内部总线上可以解决单台服务器存储扩展高性能传输的需求集中式存储时代企业规模增加存储需求增大服务器和存储独立资源利用率较低需要在不同操作系统间共享文件和应用并提高存储的扩展性提供的单机存储空间逐渐无法满足业务需求依托于局域网络的网络存储设备解决方案出现分布式存储时代随着互联网的加速发展及云计算技术诞生数据形态复杂多样规模爆发式增长对存储系统的弹性扩展和异构化需求急剧增加分布式管理软件将若干存储节点的存储空间整合到一起为前端应用服务器提供统一空间有效解决海量数据搞扩展需求降低成本根据访问方式分类直接存储固定存储介质需要物理接触存储介质才能读取数据如硬盘光盘等网络存储基于网络存储协议进行传输和访问如网络磁盘等分布式存储数据存储在多个地方通过网络进行统一管理和访问如分布式文件系统分布式数据库等存储的分类存储分类使用方式存储按照使用方式可分为共享存储一台存储设备供给多台服务器使用大多数情况下充当共享存储的设备有分布式存储独享存储存储设备或介质仅供一台服务器使用一般情况充当独享存储的设备有服务器自带硬盘直连存储存储分类数据存储方式块存储将裸磁盘空间整个映射给主机使用操作系统还需要对挂载的裸硬盘进行分区格式化后才能使用文件存储文件存储一般体现形式是目录和文件比如数据以文件的方式存储和访问按照目录结构进行组织对象存储对象存储的体现形式为比如数据和元数据打包在一起作为一个整体对象存在一个超大池子里存储分类存储介质存放位置集中式存储是指将数据存储在由一台或者多台主机组成的中心节点存储池上集中式存储所有的业务均集中部署在中心节点上中心节点统一管理各分部节点的数据按需分配数据访问仅需经过一个控制器即可实现集中式存储包括可以根据不同的数据存储需求选择不同的存储类型分布式存储是指通过网络使用企业中多台机器上的磁盘空间这些分散的存储资源构成了虚拟存储设备数据分布存储在企业的各个角落共享存储介绍简介网络接入存储具有以下特点共享存储文件存储网络接入存储一种基于网络的存储设备它提供了一种简单安全可扩展的方法来共享文件和存储数据网络通常由一个或多个硬盘驱动器组成这些驱动器通过网络连接到一台或多台服务器或客户端设备以提供存储空间的架构通常是以一个中央存储设备为核心该设备连接到网络并与其他设备进行通信这个存储设备通常由一台专用的服务器或嵌入式系统来控制它能够自动管理和备份数据并提供一个简单易用的用户界面以便用户可以访问和共享数据的架构还包括一些其他组件如存储协议如等和网络接口以便不同的设备能够连接到设备并进行数据交换此外还有一些管理工具和安全措施以确保数据安全性和完整性架构设备包括引擎和内存等一个或多个网络接口卡一个操作系统用于功能管理网络文件系统协议工业标准存储协议的磁盘资源常见协议通用网络文件系统是由微软的发展而来的一个公共开放的文件系统在主机之间可以通过一个简单的共享映射将服务器上的共享资源挂载到自己的系统中把它当成自己本地系统资源一样来使用网络文件系统是由公司开发的用于等类的操作系统中实现网络文件共享通过挂载命令将远程的文件系统挂载在自己的文件系统之下像使用本机文件一样使用远程共享文件传统的环境文件共享协议传统的微软环境下的文件共享协议基于服务器消息块协议是一个基于网络的共享协议其对网络传输的可靠性要求很高所以它通常是使用用于独立的传输所以它使用或的一个缺点是客户端必须配备专用软件被集成到操作系统中不需要额外的软件是一个无状态的协议而是一个有状态的协议连接故障后可自动恢复连接而不能仅发送少许的冗余信息因此它具有比更高的传输效率的特点通过文件级的数据访问和共享提供存储资源使客户能够以最小的存储管理开销快速直接共享文件无需建立多个文件服务器利于消除用户访问通用服务器时的瓶颈使用网络和文件共享协议进行归档和存储的优点横向扩展功能为增加存储容量就和增加硬盘一样简单不必升级或更换现有的服务器即可在不中断网络的情况下启用新的存储高性能由于专门用于提供文件服务所以其他联网设备无需再提供文件服务由于会针对具体用例如大数据或多媒体存储进行精调所以客户可以获得更好的性能易于设置架构往往会通过经简化的脚本来交付或以简化版操作系统的预安装设备的形式来交付因而可以大幅缩短存储的设置时间和系统的管理时间可访问性所有联网设备都可以访问容错性可以对进行格式化以支持复制磁盘独立磁盘冗余阵列或纠删码进而确保数据的完整性的使用场景家庭存储适用于家庭用户存储家庭影音照片等大量数据小型企业存储适用于小型企业存储和共享文件数据备份和恢复等远程办公存储支持远程访问和管理适用于远程办公人员存储和共享数据多媒体存储适用于存储和共享音频视频等多媒体数据可以作为家庭影音中心数据备份适用于数据备份和恢复确保数据的安全性和可靠性简介即网络文件系统允许计算机在远程计算机上像挂载本地分区一样挂载磁盘分区它允许在网络上快速无缝地共享文件在的应用中本地的客户端应用可以透明地读写位于远端服务器上的文件就像访问本地文件一样适用于与之间实现文件共享不能实现与间的文件共享功能服务只能基于进行认证服务所需软件主程序主程序负责的端口映射工作监听在端口程序名为可通过命令查看端口映射情况如主程序主程序提供及以及其他相关的与说明文件执行文件等的软件是服务所需要的主要软件可以将程序号码和通用地址进行转换要让某个主机能够远程主机的服务发起调用那么该主机上的必须处于运行状态需要在所有管理服务启动之前启动使用时将自动安装依赖进程远程过程调用它是一种通过网络从远程计算机程序上请求服务不需要了解底层网络技术的协议协议假定某些传输协议的存在如或为通信程序之间携带信息数据在网络通信模型中跨越了传输层和应用层采用客户机服务器模式请求程序就是一个客户机而服务提供程序就是一个服务器首先客户机调用进程发送一个有进程参数的调用信息到服务进程然后等待应答信息在服务器端进程保持睡眠状态直到调用信息到达为止当一个调用信息到达服务器获得进程参数计算结果发送答复信息然后等待下一个调用信息最后客户端调用进程接收答复信息获得进程结果然后调用执行继续进行也称为当一个服务启动时会选择一个空闲的端口号并在上面监听每次启动后的端口号各不相同同时它作为一个可用的服务在中进行注册一个服务对应唯一一个程序号服务器告诉进程它在哪个端口号上监听链接请求和为哪个程序提供服务进程一般使用的端口服务器端用户级别的过程将请求重定向到内核传输端点并调用内核内进程来处理请求并响应客户端工作机制服务器端启动及建立传输的过程服务器端先启动服务再启动进程并向注册端口信息客户端启动服务服务向服务器端请求服务端的端口服务器端服务反馈端口信息给客户端客户端通过获取的端口来建立和服务器端的连接并进行数据的传输用户建立传输及数据存取过程用户访问网站程序由程序在客户端发出存取文件的请求客户端上的服务通过网络向服务器的服务的端口发出文件存取的询问请求服务器的找到对应已注册的端口后通知客户端的服务客户端获取正确的端口并与联机存取数据客户端把数据存取成功后返回给前端访问程序告知用户存取结果作为网站用户就完成了一次存取操作服务器安装检查服务端是否安装了检查服务端是否安装了安装设置开机自启动服务服务服务器配置创建共享目录编辑配置文件增加一行内容重启服务检查是否存在共享目录表示服务端共享的目录指允许所有的机器访问共享目录如果是指定客户端则只允许该客户端主机访问或地址与之间不能有空格将登入主机的用户都设定成指定的此必须存在于中同变成客户端配置检查挂载点服务端地址挂载远程目录服务端地址检查是否挂载成功开机自动挂载编写服务端地址挂载目录为远程共享目录与地址之间用隔开为客户端挂载点指定档案系统的型态通常不必指定会自动选择正确的型态代表的是指明挂载的文件系统类型自动挂载格式要挂载的设备或伪文件系统挂载点文件系统类型挂载选项转储频率自检次序自动挂载参数要挂载的设备为服务端地址挂载点为文件系统类型为挂载选项为转储频率不做备份每天转储每隔一天转储自检次序不自检首先自检一般只有才使用存储区域网络简介存储是一种专门设计用于数据存储的网络体系结构它将大量的存储设备磁盘阵列磁带库光盘库等连接起来并提供高效的数据访问和管理服务的架构通常是由以下几个部分组成存储设备存储设备通常包括磁盘阵列磁带库光盘库等等这些设备通过光纤通道连接到存储交换机上提供高速数据传输和存储存储交换机存储交换机是存储网络的核心它负责将存储设备和主机之间的数据传输进行管理和调度存储交换机通常使用光纤通道协议进行通信主机主机是指访问存储设备的计算机系统它们连接到存储交换机上并通过存储网络访问存储设备中的数据存储的优点包括高速传输高可靠性易于管理和扩展等因此被广泛应用于企业数据存储虚拟化等领域简介小型计算机系统接口是用于计算机和智能设备之间系统级接口的独立处理器标准是基于协议的技术标准该技术允许用户通过网络来构建可以实现在网络上运行协议使其能够在诸如高速千兆以太网上进行路由选择实现了和协议的连接用于在基于的存储设备之间建立连接及管理连接在现有的网络上封装数据进行传输的基本组成会话的建立是通过启动器和目标器实现的为服务端是一个或多个存储设备的集合则是客户端使用的工具用来连接和都使用来识别端即磁盘阵列或其他装有磁盘的主机是一个或多个存储设备的集合由服务器端创建在端工作在套接字上监听端口默认是使用协议保证数据安全而则是客户端使用的工具用来连接服务器端创建的通过工具将磁盘空间映射到网络上端就可以寻找发现并使用该磁盘对客户端有身份认证的需求有两种认证方式基于认证基于认证双向认证简介的全称为用来识别设备命名格式为表示年月表示倒过来的域名全局唯一是识别名称可选在中的相关配置存放中全称它是的唯一标识符客户端正是通过这个标识符找到的有一个命名标准例如反过来的域名例如写作基于的配置流程配置安装创建为添加指定配置安装发现连接分区格式化优先配置服务端后才可以在客户端进行发现安装端安装端配置方法命令行配置由最新的管理工具提供运行在在用户态为用户提供了友好的操作界面前最受欢迎的工具提供了等的管理功能还提供了对已连接上的的检测和服务的支持依赖内核模块来帮助设备的创建修改配置文件命令无法保存配置需要将当前配置保存到配置文件中供系统下次启动时加载简介用于的临时配置重启服务后配置失效的语法格式为常用选项包括驱动程序操作对象操作是一个虚拟的存储设备可以被多个访问是上的一个逻辑存储单元可以被看作是一个独立的存储设备是上的一个用户账户用于授权访问或常用参数代表用于的扩展它是数据传输模型的扩展是的存储网络标准在利用组件的同时使用协议套件永久配置编辑配置文件使用命令可查看到当前配置将输出信息复制到配置文件中编辑配置文件增加如下命令行指定已划分的分区客户端访问控制配置案例需求在存储中创建一个名为的设置为并为该添加允许地址访问配置过程分布式存储介绍常见的分布式存储架构核心组成之一是分布式计算数据存储管理的基础被设计成适合运行在通用硬件上的分布式文件系统最初由公司开发的分布式对象存储服务年共享给开源社区统一存储支持块存储对象存储和文件存储起源于就读博士工作期间的工作成果发表于年并随后共享给了开源社区是一个开源的分布式文件系统允许将多个服务器上的存储资源组合成一个虚拟文件系统以提供更高的可靠性可扩展性性能和容错能力中间控制节点架构用户与交互的客户端切割上传文件为多个与交互获取文件信息与交互读写数据的维护文件系统树及整棵树内所有文件和目录执行实际操作表示实际存储的数据块辅助工作完全无中心架构一致性哈希完全对称面向资源的分布式架构组件可扩展避免单点故障完全无中心架构计算模式基础存储系统实现高可靠高扩展等功能并存储用户数据有和组成基础库对进行抽象和封装并向上层提供上层应用接口涵盖和应用层不同场景下对各个应用的接口的应用的功能模块客户端负责存储协议的接入节点负载均衡监控服务负责监控整个集群维护集群的健康状态维护展示集群状态的各种图表如和元数据服务负责保存文件系统的元数据管理目录结构存储服务主要功能是存储数据复制数据平衡数据恢复数据以及与其它间进行心跳检查等一般情况下一块硬盘对应一个其他分布式存储一个开源可扩展的高性能面向对象的并行文件系统被广泛应用于超级计算平台的优点支持扩展到级别的存储支持处理成千上万的客户端兼容标准使用通用硬件开源产品支持使用任何支持扩展属性的磁盘文件系统支持使用行业标准协议进行访问如支持优化不同的工作负载分布式存储功能特点高可用性能够自动检测存储节点的故障并将数据转移到其他节点上保证数据的高可用性负载均衡采用分布式存储方式能够自动将数据均匀地分散在不同的存储节点上有效地实现负载均衡可扩展性的架构可以实现随着存储需求的增加添加更多的存储节点以增加存储容量数据安全采用数据冗余的方式将数据复制到多个存储节点上以保证数据的安全性高性能的弹性哈希算法能够实现快速读写支持多个客户端并发访问提高系统的性能易于管理提供了一套完整的管理工具使得系统管理员可以轻松地管理存储节点和文件系统弹性哈希解决了对元数据服务器的依赖改善了单点故障和性能瓶颈真正实现了并行化数据访问弹性算法是算法的具体实现通过算法可以得到一个位的证书范围的值假设逻辑卷中有个存储单位则位的整数发文将被划分个连续的子空间每个空间对应一个当用户或应用程序访问某一个命名空间时通过对该命名空间计算值根据该值所对应的位整数空间定位数据所在的可以支持所有的存储它没有自制的私有数据文件格式采用操作系统中主流标准的磁盘文件系统如等来存储文件存储服务支持及原生协议完全与标准可移植操作系统接口兼容架构存储块的基本存储单元一个独立的数据存储单元可信存储池中服务器上对外提供的存储目录逻辑卷一组的集合大部分的管理操作是在卷上进行的一个内核模块允许用户创建自己的文件系统无需修改该内核代码内核空间对用户提供的访问磁盘的接口后台管理进程在存储集群中的每个节点上运行的管理进程图片来源常见卷模式介绍分布式卷复制卷分布复制卷分散卷分布式分散卷支持种卷类型分布式卷文件通过哈希算法分不到所有上为默认卷类型未对文件进行分块处理文件直接存储在某个节点上属于文件级别分散卷纠删卷分散冗余卷文件被分成数据块并以轮询的方式分布到多个上问价存储以数据块为单位不具备冗余类似复制卷将文件同步到多个上具备多个副本属于分布式分散卷数量为条带数的倍数创建一个分布式条带卷至少需要台服务器类似分布式复制卷数量为镜像数的倍数用于冗余场景类似分布式卷文件分布在卷中的各个块上因此可能只存储在或中但不能同时存储在这两个中分布式卷没有数据冗余此类存储卷的目的是轻松且便宜地扩展卷大小然而这也意味着砖块故障将导致数据完全丢失必须依靠底层硬件来保护数据丢失和存放在而存放在文件都是随机存储一个文件如要么在上要么在上不能分块同时存放在和上适用场景适合存储非关键数据如日志缓存等创建一个名为的分布式卷文件将根据分布在和中图片链接以下页出处相同复制卷复制卷中为数据创建冗余数据的副本将保存在所有上卷中的副本数量可以有客户端在创建卷时决定提高可靠性和数据冗余适用场景适合存储关键数据如数据库文件系统等同时存在和也是如此相当于中的文件是中文件的副本需要至少有两个来创建一个包含个副本的卷或者至少三个来创建一个包含个副本的卷卷中所有服务器均保存一个完整的副本具备冗余性卷的副本数量可自定义单复制数必须等于卷中所包含的存储服务器数量至少有两个以上服务器个副本的情况下发生脑裂的几率较大建议至少副本部署若多个节点上的存储空间不一致按木桶效应取最低节点的容量作为改卷的总容量分布式复制卷文件分布在复制的集上的数量必须是副本数量的倍数此外我们指定的顺序也很重要因为相邻的将成为彼此的副本如果有个副本数为那么前两块将成为彼此的副本然后是下两块依此类推此卷表示为类似地如果有个副本计数为则个将成为彼此的副本我们将此卷表示为卷和通过分布式卷的功能分别定位到和在存放时根据复制卷的特性将存在两个相同的副本分别是中的目录和中的目录在存放时根据复制卷的特性也将存在两个相同的副本分别是中的目录和中的目录适用场景适合存储关键数据如数据库文件系统等同时需要提高数据读写性能分散卷分散卷基于纠删码它将文件的编码数据条带化并添加了一些冗余跨卷中的多个存储分散冗余卷具有高可靠性并且将不浪费空间卷中的冗余数量可以与客户端在创建卷时设置冗余的数量保证不中断卷操作的情况下可以丢失多少个分散卷也被成为纠删卷分散冗余卷纠删卷适用于需要高可用性和数据保护的场景如存储重要数据数据库虚拟机镜像等有大小被分为段数据同时使用纠删码技术对数据块进行编码将原始数据块编码为个编码块编码块被分散存储在不同的物理节点上分别在中当需要读取数据时从存储数据的各个节点上获取编码块然后它使用纠删码技术将编码块解码成原始数据块并将它们组合起来返回给用户使用同样方法进行存储分布式分散卷分布式分散卷相当于分布式复制卷但使用分散的子卷而不是复制的子卷的数量必须是第一个子卷的倍数目的是轻松地缩放卷大小并在不同的之间分配负载纠删卷和分布式纠删卷都适用于需要高可用性和数据保护的场景但分布式纠删卷更适合大规模数据存储和高性能应用安装部署流程服务器端准备至少三台节点格式化和挂载安装配置防火墙配置创建并启用卷客户端配置防火墙安装客户端软件添加主机名解析配置挂载卷格式化和挂载所有的节点都需执行格式化和挂载属于同一个卷的的容量建议配置一致如果不一致则取其中最小值可以是任意文件系统的目录具体配置如下创建分区创建一个目录将其作为其中一个降分设置为开机自动挂载给卷创建卷创建命令格式为分布式卷复制卷分布式复制卷分散卷分布式分散卷卷创建命令中的选项说明卷名字传输方式支持数量用于组成卷的块可添加多个用空格隔开格式为分散卷中每个文件增加纠删码之前需要分片分散卷中每个文件最终分片文件需要被分散到多少个中冗余片分散卷中需要增加了纠删码后多出来的分片配置防火墙及防火墙配置配置信任池是由所有服务节点甚至可以包含单个节点组成的可信服务器池添加某节点进入信任池当前节点无需加入查看信任池状态每个节点上的进程需要相互访问相互通信可以在每个节点上配置端口全部对其他节点开放保证网络安全的前提下信任池中的任意数量的磁盘块可以被连接在一起形成一个大的存储卷建立信任池后只有信任池中的成员才能将新的节点加入到该信任池中新的节点无法检测到信任池必须从信任池中进行探测卷挂载卷挂载有三种方式端仅需配置即可无法多余配置即可挂载支持高可用需手动放开并重启之后上自动启动进程以便提供挂载服务器端卷开启状态下客户端安装启动并开放防火墙限制后服务器端需改并重启及后即可使用方式挂载卷还需要在服务器端创建并设置挂载目录修改权限在客户端需要安装服务器端编辑文件加入客户端验证共享目录使用进行挂载部署客户端安装客户端服务客户端添加地址解析添加到所有存储节点的解析创建挂载点并进行挂载开机自动挂载编辑文件自动挂载格式卷管理启用停止查看和再平衡启用卷停止卷查看卷信息查看单独卷状态查看卷信息再平衡卷删除卷先停止卷再执行删除卷删除卷之后释放的无法直接使用需要在对应目录中删除开头的隐藏文件再执行如下两条命令后才可以继续使用用于删除文件或目录的扩展属性其中是文件系统中的一个扩展属性用于标识文件所属的卷用于删除文件或目录的属性是文件系统中用于唯一标识文件或目录的属性使用该命令可以删除属性但不会删除文件或目录本身扩容和缩容在线扩容与缩容在线扩容在线缩容删除查看操作状态状态后提交缩容操作中卷新增后需要重新平衡布局后才可以使用该通常扩容后需要手动执行再平衡命令防止出现旧节点负载过高而出现性能问题影响数据可靠性和可用性缩容时系统会自动触发再平衡避免剔除的节点或者子卷中的数据不可用从而导致数据丢失替换损坏的在服务器端查看故障进程并结束该进程客户端卸载包含故障的卷客户端重新挂载卷到新的挂载点客户端挂载点查询查询故障节点的备份节点目的扩展属性客户端新建目录并删除客户端挂载点设置扩展属性触发自愈客户端挂载点客户端挂载点强制替换卷扩展属性是现代文件系统普遍支持而又不容易被用户发现的特性中都广泛使用了扩展属性即是一个结构包括一个字符串和一个二进制的在中当的时候会触发的相关操作每当添加删除一个的时候要重新计算中存放的哈希区间比如一个叫的卷由和两个组成那么上的文件就会具有名为的在一个上的操作会在其他所有上的中记录缩略语',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-19 03:43:54',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">XBCID's BLOG</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HCIA/" style="font-size: 1.05rem;">HCIA<sup>9</sup></a><a href="/tags/HCIP/" style="font-size: 1.05rem;">HCIP<sup>6</sup></a><a href="/tags/Huawei/" style="font-size: 1.05rem;">Huawei<sup>15</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>18</sup></a><a href="/tags/openEuler/" style="font-size: 1.05rem;">openEuler<sup>18</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">May 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">23</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">March 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">February 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Linux/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Linux</span></a><a class="article-meta__tags" href="/tags/openEuler/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>openEuler</span></a><a class="article-meta__tags" href="/tags/Huawei/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Huawei</span></a><a class="article-meta__tags" href="/tags/HCIP/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>HCIP</span></a></span></div></div><h1 class="post-title" itemprop="name headline">03 openEuler存储管理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-05-18T19:42:00.000Z" title="发表于 2025-05-19 03:42:00">2025-05-19</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-05-18T19:43:54.945Z" title="更新于 2025-05-19 03:43:54">2025-05-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为重庆"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>重庆</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"><header><a href="/tags/Linux/" tabindex="-1" itemprop="url">Linux</a><a href="/tags/openEuler/" tabindex="-1" itemprop="url">openEuler</a><a href="/tags/Huawei/" tabindex="-1" itemprop="url">Huawei</a><a href="/tags/HCIP/" tabindex="-1" itemprop="url">HCIP</a><h1 id="CrawlerTitle" itemprop="name headline">03 openEuler存储管理</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">XBCID</span><time itemprop="dateCreated datePublished" datetime="2025-05-18T19:42:00.000Z" title="发表于 2025-05-19 03:42:00">2025-05-19</time><time itemprop="dateCreated datePublished" datetime="2025-05-18T19:43:54.945Z" title="更新于 2025-05-19 03:43:54">2025-05-19</time></header><p>存储是计算机系统中非常重要的概念，它负责存储和管理数据。随着IT技术的不断发展和企业对存储需求的不断变化，存储技术和架构也在不断革新。本章我们将从存储的基本概念开始了解不同存储类型的区别及使用方法。</p>
<p>学完本课程后，您将能够:</p>
<ul>
<li>了解存储的基本概念和类型</li>
<li>掌握NAS的基本原理和使用方法</li>
<li>掌握SAN的不同类型及使用场景</li>
<li>掌握GlusterFs的基本原理及常见卷模式</li>
</ul>
<h2 id="0x01-存储的基本概念"><a href="#0x01-存储的基本概念" class="headerlink" title="0x01 存储的基本概念"></a>0x01 存储的基本概念</h2><h3 id="1-什么是数据"><a href="#1-什么是数据" class="headerlink" title="1. 什么是数据"></a>1. 什么是数据</h3><p>全球网络存储工业协会)对数SNIA( Storage Networking Industry Association）数据的定义:数据是对所有事物的数字表示<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505113707428.png"></p>
<ul>
<li>数据是指描述客观事物的符号记录，是未经加工的原始材料。一组数字，一段文字，一张图片等都可以视为数据</li>
<li>在计算机的世界里，只有0和1。所有要保存在计算机中，需要读写的数据都可以用一串由0和1组成的数字表示</li>
</ul>
<h3 id="2-什么是信息"><a href="#2-什么是信息" class="headerlink" title="2. 什么是信息"></a>2. 什么是信息</h3><ul>
<li>信息是已经被处理、具有逻辑关系的数据，是对数据的解释</li>
<li>信息是经过处理的数据，其中包括具有上下文，相关性和目的的数据</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505113828920.png"></li>
<li>信息是指从数据中提取出来的有用的知识或意义</li>
<li>数据冗余就是无用或无意义的内容</li>
</ul>
<h3 id="3-存储介绍"><a href="#3-存储介绍" class="headerlink" title="3. 存储介绍"></a>3. 存储介绍</h3><h4 id="3-1-存储基本介绍"><a href="#3-1-存储基本介绍" class="headerlink" title="3.1 存储基本介绍"></a>3.1 存储基本介绍</h4><p>数据文件&#x2F;信息需要通过电子设备进行存储，这就是数据存储，简称存储<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505114030147.png"></p>
<ul>
<li>名词存储是指计算机系统中用户保存数据和信息的介质。它可以是硬件设备，如硬盘、固态硬盘、U盘等，也可以是软件系统，如云存储和数据库等</li>
<li>动词存储是将数据或信息保存在一个物理设备中的过程，如硬盘、闪存、内存等。这些设备可以长期保存信息，即使电脑关闭或断电，数据也不会丢失</li>
<li>存储可以分为内部存储和外部存储，内部存储通常指计算机内部的存储器，例如硬盘、固态硬盘、内存等；而外部存储则指通过外部设备进行数据存储，例如USB、外置硬盘、光盘等</li>
<li>存储的基本载体–硬盘。原始的存储方法也包括纸质存储和磁带存储等</li>
<li>根据存储介质分类：<ul>
<li>硬盘存储</li>
<li>固态硬盘存储</li>
<li>光盘存储</li>
<li>磁带存储</li>
<li>云存储</li>
</ul>
</li>
</ul>
<h4 id="3-2-存储架构的演进"><a href="#3-2-存储架构的演进" class="headerlink" title="3.2 存储架构的演进"></a>3.2 存储架构的演进</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505114157899.png"></p>
<ul>
<li>最早的存储设备为打孔纸带等，计算机&#x2F;服务器普及开始，内部硬盘是存储架构演进的初始</li>
<li>单存储时代：硬盘作为服务器内置存储，由于主机内部空间导致磁盘容量受限，影响性能提升，直连存储技术DAS出现。早期企业数据规模不大，存储需求简单，外部数据存储设备直接挂在服务器内部总线上，可以解决单台服务器存储扩展、高性能传输的需求</li>
<li>集中式存储时代：企业规模增加，存储需求增大，服务器和存储独立，资源利用率较低，需要在不同操作系统间共享文件和应用，并提高存储的扩展性，DAS提供的单机存储空间逐渐无法满足业务需求，依托于局域网络的网络存储设备解决方案出现</li>
<li>分布式存储时代：随着互联网的加速发展及云计算技术诞生，数据形态复杂多样、规模爆发式增长，对存储系统的弹性扩展和异构化需求急剧增加，分布式管理软件将若干存储节点的存储空间整合到一起，为前端应用服务器提供统一空间，有效解决海量数据搞扩展需求，降低成本</li>
<li>根据访问方式分类<ul>
<li>直接存储：固定存储介质，需要物理接触存储介质才能读取数据，如硬盘、光 盘等</li>
<li>网络存储：基于网络存储协议进行传输和访问，如网络磁盘、NAS等</li>
<li>分布式存储：数据存储在多个地方，通过网络进行统一管理和访问，如分布式</li>
<li>文件系统、分布式数据库等</li>
</ul>
</li>
</ul>
<h2 id="0x02-存储的分类"><a href="#0x02-存储的分类" class="headerlink" title="0x02 存储的分类"></a>0x02 存储的分类</h2><h3 id="2-1-存储分类-使用方式"><a href="#2-1-存储分类-使用方式" class="headerlink" title="2.1 存储分类 - 使用方式"></a>2.1 存储分类 - 使用方式</h3><p>存储按照使用方式可分为:</p>
<ul>
<li>共享存储，一台存储设备供给多台服务器使用，大多数情况下，充当共享存储的设备有:<ul>
<li>SAN</li>
<li>NAS</li>
<li>分布式存储</li>
</ul>
</li>
<li>独享存储，存储设备或介质仅供一台服务器使用，一般情况，充当独享存储的设备有:<ul>
<li>服务器自带硬盘</li>
<li>直连存储</li>
</ul>
</li>
</ul>
<h3 id="2-2-存储分类-数据存储方式"><a href="#2-2-存储分类-数据存储方式" class="headerlink" title="2.2 存储分类 - 数据存储方式"></a>2.2 存储分类 - 数据存储方式</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505153850247.png"></p>
<ul>
<li>块存储<ul>
<li>将裸磁盘空间整个映射给主机使用，操作系统还需要对挂载的裸硬盘进行分区、格式化后，才能使用</li>
</ul>
</li>
<li>文件存储<ul>
<li>文件存储一般体现形式是目录和文件（比如C:\Users\Downloads\text.doc），数据以文件的方式存储和访问，按照目录结构进行组织</li>
</ul>
</li>
<li>对象存储</li>
<li>对象存储的体现形式为URL（比如<code>https://www.abc.com/app?v=nAKxJbcec8U</code>），数据和元数据打包在一起作为一个整体对象存在一个超大池子里</li>
</ul>
<h3 id="2-3-存储分类-存储介质存放位置"><a href="#2-3-存储分类-存储介质存放位置" class="headerlink" title="2.3 存储分类 - 存储介质存放位置"></a>2.3 存储分类 - 存储介质存放位置</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505160024350.png"></p>
<ul>
<li>集中式存储是指将数据存储在由一台或者多台主机组成的中心节点（存储池）上。集中式存储所有的业务均集中部署在中心节点上，中心节点统一管理各分部节点的数据，按需分配，数据访问仅需经过一个控制器即可实现。</li>
<li>集中式存储包括 DAS、NAS、SAN ，可以根据不同的数据存储需求选择不同的存储类型。</li>
<li>分布式存储是指通过网络使用企业中多台机器上的磁盘空间，这些分散的存储资源构成了虚拟存储设备，数据分布存储在企业的各个角落。</li>
</ul>
<h2 id="0x03-共享存储介绍"><a href="#0x03-共享存储介绍" class="headerlink" title="0x03 共享存储介绍"></a>0x03 共享存储介绍</h2><h3 id="3-1-NAS"><a href="#3-1-NAS" class="headerlink" title="3.1 NAS"></a>3.1 NAS</h3><h4 id="3-1-1-NAS简介"><a href="#3-1-1-NAS简介" class="headerlink" title="3.1.1 NAS简介"></a>3.1.1 NAS简介</h4><ul>
<li><p>NAS（Network-attached Storge,网络接入存储）具有以下特点：</p>
<ul>
<li>共享存储</li>
<li>文件存储</li>
</ul>
</li>
<li><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505160257889.png"></p>
</li>
<li><p>NAS（Network-attached Storage，网络接入存储）一种基于网络的存储设备，它提供了一种简单、安全、可扩展的方法来共享文件和存储数据</p>
</li>
<li><p>NAS网络通常由一个或多个硬盘驱动器组成，这些驱动器通过网络连接到一台或多台服务器或客户端设备，以提供存储空间</p>
</li>
<li><p>NAS的架构通常是以一个中央存储设备为核心，该设备连接到网络并与其他设备进行通信。这个存储设备通常由一台专用的NAS服务器或嵌入式系统来控制，它能够自动管理和备份数据，并提供一个简单易用的用户界面，以便用户可以访问和共享数据</p>
</li>
<li><p>NAS的架构还包括一些其他组件，如存储协议（如SMB、NFS、iSCSI等）和网络接口，以便不同的设备能够连接到NAS设备并进行数据交换。此外，还有一些管理工具和安全措施，以确保数据安全性和完整性</p>
</li>
</ul>
<h4 id="3-1-2-NAS架构"><a href="#3-1-2-NAS架构" class="headerlink" title="3.1.2 NAS架构"></a>3.1.2 NAS架构</h4><p>NAS设备包括</p>
<ul>
<li>NAS引擎(CPU和内存等)</li>
<li>一个或多个网络接口卡</li>
<li>一个操作系统，用于NAS功能管理</li>
<li>网络文件系统协议。</li>
<li>工业标准存储协议的磁盘资源</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505162407805.png"></p>
<h4 id="3-1-3-NAS常见协议"><a href="#3-1-3-NAS常见协议" class="headerlink" title="3.1.3 NAS常见协议"></a>3.1.3 NAS常见协议</h4><ul>
<li>CIFS(Common lnternet File system)，通用网络文件系统，是由微软的SMB(Server Message Block)发展而来的一个公共、开放的文件系统。在Windows主机之间，可以通过一个<strong>简单的共享映射</strong>，将CIFS服务器上的共享资源挂载到自己的系统中，把它当成自己本地系统资源一样来使用</li>
<li>NFS(Network File System)，网络文件系统，是由sun公司开发的，用于Linux&#x2F;UNIX&#x2F;AIX&#x2F;HP-UX&#x2F;Mac OS X等类UNIX的操作系统中实现网络文件共享。通过挂载命令将远程的文件系统<strong>挂载在自己的文件系统</strong>之下，像使用本机文件一样使用远程共享文件</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250505162522779.png"></p>
<ul>
<li>NFS：Network File System protocol，传统的UNIX环境文件共享协议</li>
<li>CIFS：Common Internet File System protocol，传统的微软环境下的文件共享协议，基于服务器消息块协议</li>
<li>CIFS是一个基于网络的共享协议，其对网络传输的可靠性要求很高，所以它通常是使用TCP&#x2F;IP。NFS用于独立的传输，所以它使用TCP或UDP</li>
<li>NFS的一个缺点是客户端必须配备专用软件。CIFS被集成到操作系统中，不需要额外的软件</li>
<li>NFS是一个无状态的协议，而CIFS是一个有状态的协议。NFS连接故障后可自动恢复连接，而CIFS不能。CIFS仅发送少许的冗余信息，因此它具有比NFS更高的传输效率</li>
</ul>
<h4 id="3-1-4-NAS的特点"><a href="#3-1-4-NAS的特点" class="headerlink" title="3.1.4 NAS的特点"></a>3.1.4 NAS的特点</h4><ul>
<li>NAS通过文件级的数据访问和共享提供存储资源，使客户能够以最小的存储管理开销快速直接共享文件</li>
<li>NAS无需建立多个文件服务器</li>
<li>NAS利于消除用户访问通用服务器时的瓶颈</li>
<li>NAS使用网络和文件共享协议进行归档和存储</li>
</ul>
<p>NAS 的优点：</p>
<ul>
<li>横向扩展功能：为NAS增加存储容量就和增加硬盘一样简单。不必升级或更换现有的服务器，即可在不中断网络的情况下启用新的存储</li>
<li>高性能：由于NAS专门用于提供文件服务，所以其他联网设备无需再提供文件服务。由于NAS会针对具体用例（如大数据或多媒体存储）进行精调，所以客户可以获得更好的性能</li>
<li>易于设置：NAS架构往往会通过经简化的脚本来交付，或以简化版操作系统的预安装设备的形式来交付，因而可以大幅缩短存储的设置时间和系统的管理时间</li>
<li>可访问性：所有联网设备都可以访问NAS</li>
<li>容错性：可以对NAS进行格式化，以支持复制磁盘、独立磁盘冗余阵列或纠删码，进而确保数据的完整性</li>
</ul>
<h4 id="3-1-5-NAS的使用场景"><a href="#3-1-5-NAS的使用场景" class="headerlink" title="3.1.5 NAS的使用场景"></a>3.1.5 NAS的使用场景</h4><ul>
<li>家庭存储：适用于家庭用户存储家庭影音、照片等大量数据</li>
<li>小型企业存储：适用于小型企业存储和共享文件、数据备份和恢复等</li>
<li>远程办公：NAS存储支持远程访问和管理，适用于远程办公人员存储和共享数据</li>
<li>多媒体存储：适用于存储和共享音频、视频等多媒体数据，可以作为家庭影音中心</li>
<li>数据备份：适用于数据备份和恢复，确保数据的安全性和可靠性</li>
</ul>
<h3 id="3-2-NFS"><a href="#3-2-NFS" class="headerlink" title="3.2 NFS"></a>3.2 NFS</h3><h4 id="3-2-1-NFS简介"><a href="#3-2-1-NFS简介" class="headerlink" title="3.2.1 NFS简介"></a>3.2.1 NFS简介</h4><ul>
<li>NFS（NetworkFileSystem）即网络文件系统，允许计算机在远程计算机上像挂载本地分区一样挂载磁盘分区。它允许在网络上快速、无缝地共享文件<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250510154538894.png"></li>
<li>在NFS的应用中，本地NFS的客户端应用可以透明地读写位于远端NFS服务器上的文件，就像访问本地文件一样</li>
<li>NFS适用于Linux与Unix之间实现文件共享，不能实现Linux与Windows间的文件共享功能</li>
<li>NFS服务只能基于IP进行认证</li>
</ul>
<h4 id="3-2-2-NFS服务所需软件"><a href="#3-2-2-NFS服务所需软件" class="headerlink" title="3.2.2 NFS服务所需软件"></a>3.2.2 NFS服务所需软件</h4><ul>
<li><p>RPC主程序:<code>rpcbind</code></p>
</li>
<li><p>RPC主程序负责NFS的端口映射工作，<strong>监听在111端口</strong>，程序名为<code>portmaper</code>，可通过<code>rpcinfo</code>命令查看端口映射情况，如：<code>rpcinfo -p localhost</code></p>
</li>
<li><p>NFS主程序：<code>nfs-utils</code></p>
</li>
<li><p>NFS主程序，提供<code>rpc.nfsd</code>及<code>rpc.mountd</code>，以及其他相关的documents与说明文件、执行文件等的软件，是NFS服务所需要的主要软件</p>
</li>
<li><p><code>rpcbind</code>可以将RPC程序号码和通用地址进行转换。要让某个主机能够远程主机的服务发起RPC调用，那么该主机上的<code>rpcbind</code>必须处于运行状态。<code>Rpcbind</code>需要在所有RPC管理服务（rpc service）启动之前启动</p>
</li>
<li><p>使用<code>yum install nfs-utils</code>时，将自动安装<code>rpcbind</code>，<code>nfs-utils</code>依赖<code>rpcbind</code>进程</p>
</li>
<li><p><code>RPC（Remote Procedure Call）</code>远程过程调用，它是一种通过网络从远程计算机程序上请求服务，<strong>不需要了解底层网络技术的协议</strong>。RPC协议假定某些传输协议的存在，如TCP或UDP，为通信程序之间携带信息数据。在OSI网络通信模型中，<strong>RPC跨越了传输层和应用层</strong></p>
</li>
<li><p>RPC采用客户机&#x2F;服务器模式。请求程序就是一个客户机，而服务提供程序就是一个服务器。首先，客户机调用进程发送一个有进程参数的调用信息到服务进程，然后等待应答信息。在服务器端，进程保持睡眠状态直到调用信息到达为止。当一个调用信息到达，服务器获得进程参数，计算结果，发送答复信息，然后等待下一个调用信息，最后，客户端调用进程接收答复信息，获得进程结果，然后调用执行继续进行</p>
</li>
<li><p><code>portmapper</code>（也称为<code>portmap</code>）当一个RPC服务启动时，会选择一个<strong>空闲的端口号</strong>并在上面监听（每次启动后的端口号各不相同），同时它作为一个可用的服务在portmap中进行注册。一个PRC服务对应唯一一个RPC程序号，RPC服务器告诉portmap进程它在哪个端口号上监听链接请求和为哪个RPC程序提供服务。Portmap进程一般使用TCP&#x2F;UDP的111端口</p>
</li>
<li><p>nfsd：服务器端用户级别的过程，将请求重定向到内核传输端点，并调用内核内进程来处理请求并响应客户端</p>
</li>
</ul>
<h4 id="3-2-3-NFS工作机制"><a href="#3-2-3-NFS工作机制" class="headerlink" title="3.2.3 NFS工作机制"></a>3.2.3 NFS工作机制</h4><ul>
<li>NFS服务器端启动及建立传输的过程<ul>
<li>服务器端先启动RPC服务，再启动NFS进程，并向RPC注册端口信息</li>
<li>客户端启动RPC服务（portmap服务），向服务器端RPC（protmap）请求服务端的NFS端口</li>
<li>服务器端RPC服务反馈NFS端口信息给客户端</li>
<li>客户端通过获取的NFS端口来建立和服务器端NFS的连接并进行数据的传输</li>
</ul>
</li>
<li>NFS用户建立传输及数据存取过程<ul>
<li>用户访问网站程序，由程序在NFS客户端发出存取NFS文件的请求，NFS客户端上的RPC服务通过网络向NFS服务器的RPC服务的111端口发出NFS文件存取的询问请求</li>
<li>NFS服务器的RPC找到对应已注册的NFS端口后，通知NFS客户端的RPC服务</li>
<li>NFS客户端获取正确的端口，并与NFSdaemon联机存取数据</li>
<li>NFS客户端把数据存取成功后，返回给前端访问程序，告知用户存取结果，作为网站用户，就完成了一次存取操作<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250510161311569.png"></li>
</ul>
</li>
</ul>
<h4 id="3-2-4-NFS服务器安装"><a href="#3-2-4-NFS服务器安装" class="headerlink" title="3.2.4 NFS服务器安装"></a>3.2.4 NFS服务器安装</h4><ul>
<li>检查服务端是否安装了nfs<ul>
<li><code>rpm -aq |grep nfs</code></li>
</ul>
</li>
<li>检查服务端是否安装了rpcbind<ul>
<li><code>rpm -aq |grep rpcbind </code></li>
</ul>
</li>
<li>安装nfs<ul>
<li><code>yum install nfs-utils</code></li>
</ul>
</li>
<li>设置开机自启动nfs服务&amp;rpcbind服务<ul>
<li><code>systemctl enable nfs --now</code></li>
</ul>
</li>
</ul>
<h4 id="3-2-5-NFS服务器配置"><a href="#3-2-5-NFS服务器配置" class="headerlink" title="3.2.5 NFS服务器配置"></a>3.2.5 NFS服务器配置</h4><ul>
<li>创建共享目录 <code>mkdir /XX/</code></li>
<li>编辑配置文件 <code>vi /etc/exports</code><ul>
<li>增加一行内容：<code>/XX/ *(rw,sync)</code></li>
</ul>
</li>
<li>重启nfs服务 <code>systemctl restart nfs</code></li>
<li>检查是否存在共享目录 <code>showmount -e</code></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250510162057873.png"></p>
<ul>
<li>&#x2F;XX&#x2F;表示服务端共享的目录</li>
<li><code>*</code> 指允许所有ip的机器访问共享目录</li>
<li>如果是指定客户端IP，则只允许该客户端ip主机访问</li>
<li><code>*</code>或IP地址与（）之间不能有空格</li>
<li><code>anonuid</code>：将登入NFS主机的用户都设定成指定的user id，此ID必须存在于&#x2F;etc&#x2F;passwd中</li>
<li><code>anongid</code>：同anonuid，变成group ID</li>
</ul>
<h4 id="3-2-6-NFS客户端配置"><a href="#3-2-6-NFS客户端配置" class="headerlink" title="3.2.6 NFS客户端配置"></a>3.2.6 NFS客户端配置</h4><ul>
<li><p>检查挂载点</p>
<ul>
<li><code>showmount -e 服务端IP地址</code></li>
</ul>
</li>
<li><p>挂载远程目录</p>
<ul>
<li><code>mount -t nfs 服务端IP地址:/XX/ /mnt/app/test</code></li>
</ul>
</li>
<li><p>检查是否挂载成功</p>
<ul>
<li><code>df -h</code></li>
</ul>
</li>
<li><p>开机自动挂载，编写&#x2F;etc&#x2F;fstab</p>
<ul>
<li><code>服务端IP地址:/xx/ 挂载目录 nfs defaults,_netdav 0 0</code></li>
</ul>
</li>
<li><p>&#x2F;XX&#x2F;为远程共享目录，与ip地址之间用“:”隔开</p>
</li>
<li><p>&#x2F;mnt&#x2F;app&#x2F;test&#x2F;为客户端挂载点</p>
</li>
<li><p>mount –t：指定档案系统的型态，通常不必指定。mount 会自动选择正确的型态</p>
</li>
<li><p>-t nfs代表的是指明挂载的文件系统类型</p>
</li>
<li><p>自动挂载格式：要挂载的设备或伪文件系统 挂载点 文件系统类型 挂载选项 转储<br>频率 自检次序</p>
</li>
<li><p>NFS自动挂载参数：</p>
<ul>
<li>要挂载的设备为：</li>
<li>服务端IP地址:&#x2F;xx&#x2F;</li>
<li>挂载点为：&#x2F;mnt&#x2F;app&#x2F;test</li>
<li>文件系统类型为： nfs</li>
<li>挂载选项为：defaults</li>
<li>转储频率： 0不做备份；1每天转储；2每隔一天转储</li>
<li>自检次序：0不自检；1首先自检，一般只有rootfs才使用1</li>
</ul>
</li>
</ul>
<h3 id="3-3-存储区域网络SAN"><a href="#3-3-存储区域网络SAN" class="headerlink" title="3.3 存储区域网络SAN"></a>3.3 存储区域网络SAN</h3><h4 id="3-3-1-SAN简介"><a href="#3-3-1-SAN简介" class="headerlink" title="3.3.1 SAN简介"></a>3.3.1 SAN简介</h4><ul>
<li>SAN存储（StorageAreaNetwork）是一种专门设计用于数据存储的网络体系结构，它将大量的存储设备（磁盘阵列、磁带库、光盘库等）连接起来，并提供高效的数据访问和管理服务<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250510163000947.png"></li>
</ul>
<p>SAN的架构通常是由以下几个部分组成：</p>
<ul>
<li>存储设备：存储设备通常包括磁盘阵列、磁带库、光盘库等等。这些设备通过光纤通道连接到存储交换机上，提供高速数据传输和存储</li>
<li>存储交换机：存储交换机是SAN存储网络的核心，它负责将存储设备和主机之间的数据传输进行管理和调度</li>
<li>存储交换机通常使用光纤通道协议（Fiber Channel）进行通信</li>
<li>主机：主机是指访问存储设备的计算机系统，它们连接到存储交换机上，并通过SAN存储网络访问存储设备中的数据<br>SAN存储的优点包括高速传输、高可靠性、易于管理和扩展等，因此被广泛应用于企业数据存储、虚拟化等领域</li>
</ul>
<h4 id="3-3-2-iSCSI"><a href="#3-3-2-iSCSI" class="headerlink" title="3.3.2 iSCSI"></a>3.3.2 iSCSI</h4><h5 id="3-3-2-1-iSCSI简介"><a href="#3-3-2-1-iSCSI简介" class="headerlink" title="3.3.2.1 iSCSI简介"></a>3.3.2.1 iSCSI简介</h5><ul>
<li>iSCSI（小型计算机系统接口）是用于计算机和智能设备之间系统级接口的独立处理器标准。</li>
<li>iSCSI是基于IP协议的技术标准，该技术允许用户通过TCP&#x2F;IP网络来构建SAN</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250510164237590.png"></li>
<li>iSCSI可以实现在IP网络上运行SCSI协议，使其能够在诸如高速千兆以太网上进行路由选择，实现了SCSI和TCP&#x2F;IP协议的连接</li>
<li>iSCSI：用于在基于IP的存储设备之间建立连接及管理连接，在现有的IP网络上封装SCSI数据进行传输</li>
</ul>
<h5 id="3-3-2-2-iSCSI的基本组成"><a href="#3-3-2-2-iSCSI的基本组成" class="headerlink" title="3.3.2.2 iSCSI的基本组成"></a>3.3.2.2 iSCSI的基本组成</h5><ul>
<li><p>iSCSI会话的建立是通过启动器（Initiator）和目标器（Target）实现的</p>
</li>
<li><p>Target为服务端，是一个或多个存储设备（LUN）的集合</p>
</li>
<li><p>Initiator则是客户端使用的工具，用来连接target</p>
</li>
<li><p>Target和initiator都使用IQN来识别<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250510164413119.png"></p>
</li>
<li><p>Target端即磁盘阵列或其他装有磁盘的主机，是一个或多个存储设备（LUN）的集合，由服务器端创建。iscsi在target端工作在套接字上，监听端口默认是3260，使用tcp协议保证数据安全</p>
</li>
<li><p>而initiator则是客户端使用的工具，用来连接服务器端创建的target，通过iscsi target工具将磁盘空间映射到网络上，initiator端就可以寻找发现并使用该磁盘。</p>
</li>
<li><p>iscsi对客户端有身份认证的需求，有两种认证方式：基于IP认证，基于CHAP认证（双向认证）</p>
</li>
</ul>
<h5 id="3-3-2-3-IQN简介"><a href="#3-3-2-3-IQN简介" class="headerlink" title="3.3.2.3 IQN简介"></a>3.3.2.3 IQN简介</h5><ul>
<li><p>IQN的全称为iSCSIQualified Name，用来识别iSCSI设备</p>
</li>
<li><p>IQN命名格式为:<code>iqn.yyyy-mm.&lt;reversed domain name&gt;[:identifier]</code></p>
<ul>
<li>yyyy-mm表示“年-月”</li>
<li>reversed domain name表示倒过来的域名，全局唯一</li>
<li>identifier是识别名称，可选</li>
</ul>
</li>
<li><p>在openEuler中，initiator的IQN相关配置存放<code>/etc/iscsi/initiatorname.iscsi</code>中</p>
</li>
<li><p>iqn全称ISCSI Qualified Name，它是target的唯一标识符，客户端正是通过这个标识符找到target的。IQN有一个命名标准，例如：<code>iqn.20XX-XX.com.example:storage1</code></p>
</li>
<li><p>反过来的域名例如：test.com 写作com.test</p>
</li>
</ul>
<h4 id="3-3-3-基于Linux的SAN配置流程"><a href="#3-3-3-基于Linux的SAN配置流程" class="headerlink" title="3.3.3 基于Linux的SAN配置流程"></a>3.3.3 基于Linux的SAN配置流程</h4><p>Target配置</p>
<ul>
<li><p>安装target</p>
</li>
<li><p>创建target</p>
</li>
<li><p>为target添加LUN</p>
</li>
<li><p>指定Initiator<br>Initiator配置</p>
</li>
<li><p>安装Initiator</p>
</li>
<li><p>发现target</p>
</li>
<li><p>连接target</p>
</li>
<li><p>分区、格式化</p>
</li>
<li><p>优先配置服务端target后才可以在客户端进行发现</p>
</li>
<li><p>安装target端：  <code>yum install –y scsi-target-utils</code></p>
</li>
<li><p>安装initiator端：<code>yum -y install iscsi-initiator-utils</code></p>
</li>
</ul>
<h5 id="3-3-3-1-Target配置方法"><a href="#3-3-3-1-Target配置方法" class="headerlink" title="3.3.3.1 Target配置方法"></a>3.3.3.1 Target配置方法</h5><p>命令行配置</p>
<ul>
<li>Targetcli:由最新的target管理工具LIO（Linux-lOTarget）提供，运行在在用户态，为用户提供了友好的操作界面</li>
<li>Tgtadm：LIO前最受欢迎的target工具，提供了LUN、ACL等的管理功能，还提供了对已连接上的initiator的检测和iSNS服务的支持</li>
<li>letadm:依赖内核模块iscsi_trgt.ko来帮助iSCSl设备的创建<br>修改配置文件</li>
<li>Tgtadm命令无法保存配置，需要将当前配置保存到配置文件中，供系统下次启动时加载</li>
</ul>
<h6 id="3-3-3-1-1-Tgtadm简介"><a href="#3-3-3-1-1-Tgtadm简介" class="headerlink" title="3.3.3.1.1 Tgtadm简介"></a>3.3.3.1.1 Tgtadm简介</h6><ul>
<li><p>Tgtadm用于target的l临时配置，重启target服务后，配置失效</p>
</li>
<li><p>Tgtadm的语法格式为: <code>tgtadm --lld [driver] --op [operation] --mode [mode][OPTION]...</code></p>
</li>
<li><p>Tagadm常用选项包括：</p>
<ul>
<li>Driver驱动程序<ul>
<li>iscsi</li>
</ul>
</li>
<li>Mode 操作对象<ul>
<li>target</li>
<li>logicalunit</li>
<li>account</li>
</ul>
</li>
<li>OPTION操作<ul>
<li>delete</li>
<li>new</li>
<li>bind&amp; unbind</li>
<li>show</li>
</ul>
</li>
</ul>
</li>
<li><p>target：iSCSI Target是一个虚拟的存储设备，可以被多个iSCSI Initiator访问</p>
</li>
<li><p>logicalunit：是iSCSI Target上的一个逻辑存储单元，可以被iSCSI Initiator看作是一个独立的存储设备</p>
</li>
<li><p>account：Account是iSCSI Target上的一个用户账户，用于授权iSCSI Initiator访问Target或Logical Unit</p>
</li>
</ul>
<h6 id="3-3-3-1-2-Tgtadm常用参数"><a href="#3-3-3-1-2-Tgtadm常用参数" class="headerlink" title="3.3.3.1.2 Tgtadm常用参数"></a>3.3.3.1.2 Tgtadm常用参数</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/file-20250510165228253.png"></p>
<p>iSER 代表“用于 RDMA 的 iSCSI 扩展”（iSCSI Extensions for RDMA)。它是 iSCSI数据传输模型的扩展，iSCSI 是 TCP&#x2F;IP 的存储网络标准。iSER在利用 iSCSI 组件的同时使用RDMA 协议套件</p>
<h6 id="3-3-3-1-3-Target永久配置-编辑配置文件"><a href="#3-3-3-1-3-Target永久配置-编辑配置文件" class="headerlink" title="3.3.3.1.3 Target永久配置 - 编辑配置文件"></a>3.3.3.1.3 Target永久配置 - 编辑配置文件</h6><ul>
<li>使用命令 <code>tgt-admin --dump</code>可查看到当前配置，将输出信息复制到配置文件中</li>
<li>编辑配置文件<code>/etc/tgt/targets.conf</code>，增加如下命令行：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;target iqn.2018-09.com.example:target1&gt;</span><br><span class="line">	backing-store                 /dev/vdb1       #指定已划分的分区</span><br><span class="line">	initiator-address             192.168.1.11    #客户端访问控制</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="3-3-3-2-Target配置案例"><a href="#3-3-3-2-Target配置案例" class="headerlink" title="3.3.3.2 Target配置案例"></a>3.3.3.2 Target配置案例</h5><p>需求：在SAN存储中创建一个名为<code>iqn.2023.04.com.openeuler:target1</code>的target，tid设置<br>为1，并为该target添加LUN <code>/dev/vdb</code>，允许地址192.168.1.1访问<br>配置过程：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="meta">@web</span> ~]# yum -y install scsi-target-utils</span><br><span class="line">[root<span class="meta">@web</span>~]# tgtadm--lld iscsi--mode target--op <span class="keyword">new</span>--tid <span class="number">1</span> --targetname iqn<span class="number">.2023</span>-<span class="number">04.</span>com.openeuler:target1</span><br><span class="line">[root<span class="meta">@web</span> ~]# tgtadm--lld iscsi --mode logicalunit-op <span class="keyword">new</span>-tid <span class="number">1</span>--lun <span class="number">1</span> --backing-store /dev/vdb</span><br><span class="line">[root<span class="meta">@web</span>~]# tgtadm--ld iscsi --mode target--op bind--tid <span class="number">1</span> --initiator-address <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">[root<span class="meta">@web</span> ~]# tgt-admin--dump</span><br><span class="line"><span class="keyword">default</span>-driver iscsi</span><br><span class="line">&lt;target iqn<span class="number">.2023</span>-<span class="number">04.</span>com.openeuler:target1&gt;</span><br><span class="line">backing-store /dev/sdb</span><br><span class="line">initiator-address <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">&lt;/target&gt;</span><br><span class="line">[root<span class="meta">@web</span> ~]# tgt-admin --dump I grep -A <span class="number">4</span> target &gt;&gt; /etc/tgt/targets.conf</span><br></pre></td></tr></table></figure>


<h2 id="0x04-分布式存储介绍"><a href="#0x04-分布式存储介绍" class="headerlink" title="0x04 分布式存储介绍"></a>0x04 分布式存储介绍</h2><h3 id="4-1-常见的分布式存储架构"><a href="#4-1-常见的分布式存储架构" class="headerlink" title="4.1 常见的分布式存储架构"></a>4.1 常见的分布式存储架构</h3><ul>
<li><p>HDFS</p>
<ul>
<li>Hadoop核心组成之一，是分布式计算数据存储管理的基础，被设计成适合运行在通用硬件上的分布式文件系统</li>
</ul>
</li>
<li><p>Swift</p>
<ul>
<li>最初由Rackspace公司开发的分布式对象存储服务，2010年共享给OpenStack开源社区</li>
</ul>
</li>
<li><p>Ceph</p>
<ul>
<li>统一存储，支持块存储、对象存储和文件存储</li>
<li>起源于Sage就读博士工作期间的工作，成果发表于2004年，并随后共享给了开源社区</li>
</ul>
</li>
<li><p>Glusterfs</p>
<ul>
<li>GlusterFS是一个开源的分布式文件系统，允许将多个服务器上的存储资源组合成一个虚拟文件系统，以提供更高的可靠性、可扩展性、性能和容错能力</li>
</ul>
</li>
<li><p>HDFS：中间控制节点架构</p>
<ul>
<li>Client：用户与HDFS交互的客户端，切割上传文件为多个Block，与NameNode交互获取文件信息，与DataNode交互读写数据</li>
<li>NameNode：HDFS的Master，维护文件系统树，及整棵树内所有文件和目录</li>
<li>DataNode：执行实际操作，表示实际存储的数据块</li>
<li>Scondary NameNode： 辅助NameNode工作</li>
</ul>
</li>
<li><p>Swift：完全无中心架构–一致性哈希</p>
<ul>
<li>完全对称、面向资源的分布式架构，组件可扩展，避免单点故障</li>
</ul>
</li>
<li><p>Ceph：完全无中心架构—计算模式</p>
<ul>
<li>基础存储系统RADOS，实现高可靠、高扩展等功能，并存储用户数据，有CephOSD和Ceph Monitors组成</li>
<li>基础库LIBRADOS，对RADOS进行抽象和封装，并向上层提供API</li>
<li>上层应用接口，涵盖RADOSGW（RADOS Gateway）、RBD（Reliable Block Device）和Ceph FS（Ceph File System）</li>
<li>应用层，不同场景下对Ceph各个应用的接口的应用</li>
</ul>
</li>
<li><p>Ceph的功能模块：</p>
</li>
<li><p>Client客户端：负责存储协议的接入，节点负载均衡</p>
</li>
<li><p>MON监控服务：负责监控整个集群，维护集群的健康状态，维护展示集群状态的各种图表，如OSD Map、Monitor Map、PG Map和CRUSH Map</p>
</li>
<li><p>MDS元数据服务：负责保存文件系统的元数据，管理目录结构</p>
</li>
<li><p>OSD存储服务：主要功能是存储数据、复制数据、平衡数据、恢复数据，以及与其它OSD间进行心跳检查等。一般情况下一块硬盘对应一个OSD</p>
</li>
</ul>
<p>其他分布式存储：</p>
<ul>
<li>Lustre一个开源、可扩展的高性能面向对象的并行文件系统，被广泛应用于超级计算平台HPC</li>
</ul>
<h3 id="4-2-GlusterFS的优点"><a href="#4-2-GlusterFS的优点" class="headerlink" title="4.2 GlusterFS的优点"></a>4.2 GlusterFS的优点</h3><ul>
<li>支持扩展到PB级别的存储</li>
<li>支持处理成千上万的客户端</li>
<li>兼容POSIX标准</li>
<li>使用通用硬件</li>
<li>开源产品</li>
<li>支持使用任何支持扩展属性的磁盘文件系统</li>
<li>支持使用行业标准协议进行访问，如：NFS、SMB</li>
<li>支持优化不同的工作负载</li>
</ul>
<h3 id="4-3-GlusterFS分布式存储功能特点"><a href="#4-3-GlusterFS分布式存储功能特点" class="headerlink" title="4.3 GlusterFS分布式存储功能特点"></a>4.3 GlusterFS分布式存储功能特点</h3><ul>
<li><p>高可用性：GlusterFs能够自动检测存储节点的故障，并将数据转移到其他节点上，保证数据的高可用性。</p>
</li>
<li><p>负载均衡：GlusterFS采用分布式存储方式，能够自动将数据均匀地分散在不同的存储节点上，有效地实现负载均衡</p>
</li>
<li><p>可扩展性：GluserFS的Scale-Out架构可以实现随着存储需求的增加，添加更多的存储节点，以增加存储容量。</p>
</li>
<li><p>数据安全：GlusterFS采用数据冗余的方式，将数据复制到多个存储节点上，以保证数据的安全性</p>
</li>
<li><p>高性能：GlusterFS的弹性哈希算法能够实现快速读写，支持多个客户端并发访问，提高系统的性能</p>
</li>
<li><p>易于管理：GlusterFS提供了一套完整的管理工具，使得系统管理员可以轻松地管理存储节点和文件系统</p>
</li>
<li><p>GlusterFS弹性哈希解决了GlusterFS对元数据服务器的依赖，改善了单点故障和性能瓶颈，真正实现了并行化数据访问</p>
<ul>
<li>弹性HASH算法是Davis-Meyer算法的具体实现，通过HASH算法可以得到一个32位的证书范围的hash值</li>
<li>假设逻辑卷中有N个存储单位Brick，则32位的整数发文将被划分N个连续的子空间，每个空间对应一个rick</li>
<li>当用户或应用程序访问某一个命名空间时，通过对该命名空间计算HASH值，根据该 HASH 值所对应的 32 位整数空间定位数据所在的Brick</li>
</ul>
</li>
<li><p>GlusterFS可以支持所有的存储，它没有自制的私有数据文件格式，采用操作系统中主流标准的磁盘文件系统（如EXT3、XFS等）来存储文件。Gluster存储服务支持NFS、CIFS、HTTP、FTP、SMB及Gluster原生协议，完全与POSIX标准（可移植操作系统接口）兼容</p>
</li>
</ul>
<h3 id="4-4-GlusterFS架构"><a href="#4-4-GlusterFS架构" class="headerlink" title="4.4 GlusterFS架构"></a>4.4 GlusterFS架构</h3><ul>
<li>Brick：存储块<ul>
<li>GlusterFS的基本存储单元，一个独立的数据存储单元，可信存储池中服务器上对外提供的存储目录</li>
</ul>
</li>
<li>Volume：逻辑卷<ul>
<li>一组Brick的集合，大部分的Gluster管理操作是在卷上进行的</li>
</ul>
</li>
<li>FUSE：<ul>
<li>一个内核模块，允许用户创建自己的文件系统，无需修改该内核代码</li>
</ul>
</li>
<li>VFS：<ul>
<li>内核空间对用户提供的访问磁盘的接口</li>
</ul>
</li>
<li>Glusterd：后台管理进程<ul>
<li>在存储集群中的每个节点上运行的管理进程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/file-20250519020610026.png"><br>图片来源：<a target="_blank" rel="noopener" href="https://docs.gluster.org/en/latest/Quick-Start-Guide/Architecture/">https://docs.gluster.org/en/latest/Quick-Start-Guide/Architecture/</a></li>
</ul>
</li>
</ul>
<h3 id="4-4-GlusterFS常见卷模式介绍"><a href="#4-4-GlusterFS常见卷模式介绍" class="headerlink" title="4.4 GlusterFS常见卷模式介绍"></a>4.4 GlusterFS常见卷模式介绍</h3><ul>
<li><p>Distribute   分布式卷</p>
</li>
<li><p>Replicated   复制卷</p>
</li>
<li><p>Distribute Replication  分布复制卷</p>
</li>
<li><p>Dispersed    分散卷</p>
</li>
<li><p>Distribute Dispersed    分布式分散卷</p>
</li>
<li><p>GlusterFS支持7种卷类型</p>
<ul>
<li>分布式卷：文件通过哈希算法分不到所有Brick Server上，为默认卷类型，未对文件进行分块处理，文件直接存储在某个Server节点上，属于文件级别RAID0</li>
<li>分散卷：（纠删卷&#x2F;分散冗余卷）文件被分成数据块并以轮询的方式分布到多个Brick Server上，问价存储以数据块为单位，不具备冗余，类似RAID5&#x2F;6</li>
<li>复制卷：将文件同步到多个Brick Server上，具备多个副本，属于RAID1</li>
<li>分布式分散卷：Brick Server数量为条带数的倍数，创建一个分布式条带卷至少需要4台服务器，类似RAID50</li>
<li>分布式复制卷：Brick Server数量为镜像数的倍数，用于冗余场景，类似RAIDI10</li>
</ul>
</li>
</ul>
<h4 id="4-4-1-分布式卷-Distributed-Glusterfs-Volume"><a href="#4-4-1-分布式卷-Distributed-Glusterfs-Volume" class="headerlink" title="4.4.1 分布式卷 Distributed Glusterfs Volume"></a>4.4.1 分布式卷 Distributed Glusterfs Volume</h4><ul>
<li>文件分布在卷中的各个块上。因此，File1可能只存储在Brick 1或Brick 2中，但不能同时存储在这两个中。分布式卷没有数据冗余</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/file-20250519030317623.png"></li>
<li>此类存储卷的目的是轻松且便宜地扩展卷大小。然而，这也意味着砖块故障将导致数据完全丢失，必须依靠底层硬件来保护数据丢失</li>
<li>File1和File2存放在Server1，而File3存放在Server2，文件都是随机存储，一个文件（如File1）要么在Server1上，要么在Server2上，不能分块同时存放在Server1和Server2上</li>
<li>适用场景：适合存储非关键数据，如日志、缓存等</li>
<li>创建一个名为dis-volume的分布式卷，文件将根据HASH分布在server1:&#x2F;exp1、server2:&#x2F;exp2和server3:&#x2F;exp3中</li>
<li>gluster volume create dis-volume server1:&#x2F;esp1 server2:&#x2F;exp2 server3:&#x2F;exp3</li>
<li>图片链接：Architecture - Gluster Docs，以下４页出处相同</li>
</ul>
<h4 id="4-4-2-复制卷-Replicated-Glusterfs-Volume"><a href="#4-4-2-复制卷-Replicated-Glusterfs-Volume" class="headerlink" title="4.4.2 复制卷 Replicated Glusterfs Volume"></a>4.4.2 复制卷 Replicated Glusterfs Volume</h4><ul>
<li>复制卷中为数据创建冗余，数据的副本将保存在所有Brick上。卷中的副本数量可以有客户端在创建卷时决定。提高可靠性和数据冗余</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/file-20250519030524486.png"></li>
<li>适用场景：适合存储关键数据，如数据库、文件系统等</li>
<li>File1 同时存在 Server1 和 Server2，File2 也是如此，相当于 Server2 中的文件是Server1 中文件的副本。</li>
<li>需要至少有两个Brick来创建一个包含2个副本的卷，或者至少三个Brick来创建一个包含3个副本的卷。</li>
<li>卷中所有服务器均保存一个完整的副本，具备冗余性</li>
<li>卷的副本数量可自定义，单复制数必须等于卷中Brick所包含的存储服务器数量</li>
<li>至少有两个以上服务器，2个副本的情况下，发生脑裂的几率较大，建议至少3副本部署。</li>
<li>若多个节点上的存储空间不一致，按木桶效应取最低节点的容量作为改卷的总容量</li>
</ul>
<h4 id="4-4-3-分布式复制卷-Distributed-Replicated-Glusterfs-Volume"><a href="#4-4-3-分布式复制卷-Distributed-Replicated-Glusterfs-Volume" class="headerlink" title="4.4.3 分布式复制卷 Distributed Replicated Glusterfs Volume"></a>4.4.3 分布式复制卷 Distributed Replicated Glusterfs Volume</h4><ul>
<li>文件分布在复制的Brick集上。Brick的数量必须是副本数量的倍数。此外我们指定Brick的顺序也很重要，因为相邻的Brick将成为彼此的副本</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/file-20250519030858914.png"></li>
<li>如果有8个Brick，副本数为2，那么前两块Brick将成为彼此的副本，然后是下两块Brick，依此类推。此卷表示为4x2。类似地，如果有8个Brick，副本计数为4，则4个Brick将成为彼此的副本，我们将此卷表示为2x4卷</li>
<li>File1 和 File2 通过分布式卷的功能分别定位到 Server1 和 Server3。在存放 File1 时，File1 根据复制卷的特性，将存在两个相同的副本，分别是 Server1 中的exp1 目录和Server2 中的 exp2 目录。在存放 File2 时，File2 根据复制卷的特性，也将存在两个相同的副本，分别是 Server3 中的 exp3 目录和 Server4 中的 exp4 目录</li>
<li>适用场景：适合存储关键数据，如数据库、文件系统等，同时需要提高数据读写性能</li>
</ul>
<h4 id="4-4-4-分散卷-Dispersed-Glusterfs-Volume"><a href="#4-4-4-分散卷-Dispersed-Glusterfs-Volume" class="headerlink" title="4.4.4 分散卷 Dispersed Glusterfs Volume"></a>4.4.4 分散卷 Dispersed Glusterfs Volume</h4><ul>
<li>分散卷基于纠删码。它将文件的编码数据条带化，并添加了一些冗余，跨卷中的多个Brick存储。分散冗余卷具有高可靠性，并且将不浪费空间。卷中的冗余Brick数量可以与客户端在创建卷时设置</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/file-20250519031125749.png"></li>
<li>冗余Brick的数量保证不中断卷操作的情况下可以丢失多少个Brick</li>
<li>分散卷也被成为纠删卷&#x2F;分散冗余卷</li>
<li>纠删卷适用于需要高可用性和数据保护的场景，如存储重要数据、数据库、虚拟机镜像等</li>
<li>File 1有10MB大小，被分为2段数据，同时使用纠删码技术对数据块进行编码，将原始数据块编码为3个编码块，编码块被分散存储在不同的物理节点上，分别在Server1、Server2、Server3中，当需要读取数据时，Dispersed Volume从存储数据的各个节点上获取编码块。然后，它使用纠删码技术将编码块解码成原始数据块，并将它们组合起来返回给用户。File 2使用同样方法进行存储</li>
</ul>
<h4 id="4-4-5-分布式分散卷Distributed-Dispersed-Glusterfs-Volume"><a href="#4-4-5-分布式分散卷Distributed-Dispersed-Glusterfs-Volume" class="headerlink" title="4.4.5 分布式分散卷Distributed Dispersed Glusterfs Volume"></a>4.4.5 分布式分散卷Distributed Dispersed Glusterfs Volume</h4><ul>
<li>分布式分散卷相当于分布式复制卷，但使用分散的子卷而不是复制的子卷。Brick的数量必须是第一个子卷的倍数。目的是轻松地缩放卷大小，并在不同的Brick之间分配负载</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/file-20250519031232645.png"></li>
<li>纠删卷和分布式纠删卷都适用于需要高可用性和数据保护的场景，但分布式纠删卷更适合大规模数据存储和高性能应用</li>
</ul>
<h3 id="4-5-安装部署GlusterFS"><a href="#4-5-安装部署GlusterFS" class="headerlink" title="4.5 安装部署GlusterFS"></a>4.5 安装部署GlusterFS</h3><h4 id="4-5-1-流程"><a href="#4-5-1-流程" class="headerlink" title="4.5.1 流程"></a>4.5.1 流程</h4><ul>
<li>服务器端<ul>
<li>准备至少三台node节点</li>
<li>格式化和挂载bricks</li>
<li>安装glusterfs-server</li>
<li>配置防火墙</li>
<li>配置trusted pool</li>
<li>创建并启用GlusterFS卷</li>
</ul>
</li>
<li>客户端<ul>
<li>配置防火墙</li>
<li>安装客户端软件</li>
<li>添加node主机名解析配置</li>
<li>挂载GlusterFS卷</li>
</ul>
</li>
</ul>
<h4 id="4-5-2-格式化和挂载bricks"><a href="#4-5-2-格式化和挂载bricks" class="headerlink" title="4.5.2 格式化和挂载bricks"></a>4.5.2 格式化和挂载bricks</h4><ul>
<li>所有的节点都需执行格式化和挂载bricks</li>
<li>属于同一个卷的bricks的容量建议配置一致，如果不一致则取其中最小值</li>
<li>Bricks可以是任意文件系统的目录</li>
<li>具体配置如下：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkfs.xfs -i size=512 /dev/sdb1     ####创建分区sdb1</span><br><span class="line">mkdir -p /data/brick1              ####创建一个目录，将其作为其中一个brick</span><br><span class="line">echo &#x27;/dev/sdb1 /data/brick1 xfs defaults 1 2&#x27; &gt;&gt; /etc/fstab                 ####降分sdb1设置为开机自动挂载给brick</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="4-5-3-卷创建"><a href="#4-5-3-卷创建" class="headerlink" title="4.5.3 卷创建"></a>4.5.3 卷创建</h4><ul>
<li><p>GlusterFS卷创建命令格式为：</p>
<ul>
<li>分布式卷: <code>gluster volume create &lt;volume-name&gt; [transport [tcp | rdma| tcp,rdma]] brick1,brick2...</code></li>
</ul>
</li>
<li><p>复制卷: <code>gluster volume create &lt;volume-name&gt; [replica COuNT] [transport [tcp Irdma tcp,rdmal]] brick1,brick2...</code></p>
</li>
<li><p>分布式复制卷:<code>gluster volume create &lt;volume-name&gt; [replica COUNT] [transport [tcp rdma | tcp,rdma]] brick1,brick-2...</code></p>
</li>
<li><p>分散卷: <code>gluster volume create &lt;volume-name&gt; [disperse [&lt;COUNT&gt;]][disperse-data &lt;COUNT&gt;] [redundancy &lt;COUNT&gt;] [transport tcp | rdma | tcp,rdma] brick1,brick2...</code></p>
</li>
<li><p>分布式分散卷:<code>gluster volume create &lt;volume-name&gt; [disperse [&lt;COUNT&gt;]] [disperse-data &lt;COUNT&gt;] [redundancy &lt;COUNT&gt;] [transport tcp | rdma | tcp,rdma]brick1,brick2...</code></p>
</li>
<li><p>卷创建命令中的选项说明：</p>
<ul>
<li>volume-name:卷名字</li>
<li>Transport:传输方式，支持tcp、rdma、tcp,rdma</li>
<li>COUNT:数量</li>
<li>brick1,brick2.:用于组成卷的brick块，可添加多个用空格隔开，格式为nodeX:&#x2F;XX</li>
<li>disperse-data：分散卷中每个文件增加纠删码之前需要分片</li>
<li>disperse：分散卷中每个文件最终分片，文件需要被分散到多少个Brick中</li>
<li>redundancy：冗余片，分散卷中需要增加了纠删码后多出来的分片</li>
</ul>
</li>
</ul>
<h4 id="4-5-4-配置防火墙及trusted-pool"><a href="#4-5-4-配置防火墙及trusted-pool" class="headerlink" title="4.5.4 配置防火墙及trusted pool"></a>4.5.4 配置防火墙及trusted pool</h4><ul>
<li><p>防火墙配置：</p>
<ul>
<li><code>iptables -I INPUT -p all -s &lt;other-ip-address&gt; -j ACCEPT</code></li>
</ul>
</li>
<li><p>Trusted pool配置：</p>
<ul>
<li>信任池（Trustedpool）是由所有GlusterFS服务节点（TSP甚至可以包含单个节点）组成的可信服务器池(TSP)。</li>
<li>添加某节点进入信任池（当前节点无需加入）：<code>gluster peer probe nodeX</code></li>
<li>查看信任池状态：<code>gluster peer status</code></li>
</ul>
</li>
<li><p>每个节点上的Gluster进程需要相互访问、相互通信，可以在每个节点上配置端口全部对其他节点开放（保证网络安全的前提下）</p>
</li>
<li><p>信任池中的任意数量的磁盘块可以被连接在一起形成一个大的存储卷</p>
</li>
<li><p>建立信任池后，只有信任池中的成员才能将新的节点加入到该信任池中，新的节点无法检测到信任池，必须从信任池中进行探测</p>
</li>
</ul>
<h4 id="4-5-5-卷挂载"><a href="#4-5-5-卷挂载" class="headerlink" title="4.5.5 卷挂载"></a>4.5.5 卷挂载</h4><ul>
<li><p>GlusterFS卷挂载有三种方式：</p>
<ul>
<li>GlusterNativeClient：server端仅需配置glusterfs即可无法多余配置即可挂载，支持高可用<ul>
<li><code>mount-t glusterfs nodeX:NEW-VOLNAME /mnt/XX</code></li>
</ul>
</li>
<li>NFSv3：需手动放开nfs，并重启volume之后server上自动启动nfs进程以便提供nfs挂载<ul>
<li><code>gluster volume set VOLNAME nfs.disable off</code></li>
<li><code>mount -t nfs nodeX:NEW-VOLNAME /mnt/XX</code></li>
</ul>
</li>
<li>SAMBA：服务器端卷nfs.disable开启状态下，客户端安装启动samba并开放防火墙限制后，服务器端需改volumeoption并重启volume及glusterdservice后即可使用</li>
</ul>
</li>
<li><p>SAMBA方式挂载卷，还需要在服务器端创建samba user，并设置挂载目录修改权限，在客户端需要安装samba-client , cifs-utils</p>
</li>
<li><p>服务器端：</p>
<ul>
<li>编辑&#x2F;etc&#x2F;glusterfs&#x2F;glusterd.vol 文件加入：option rpc-auth-allow-insecure on</li>
<li>gluster volume set VOLNAME server.allow-insecure on</li>
<li>gluster volume set VOLNAME storage.batch-fsync-delay-usec 0</li>
<li>gluster volume set VOLNAME stat-prefetch off</li>
<li>adduser –s &#x2F;sbin&#x2F;nologin smbuser</li>
<li>smbpasswd –a smbuser</li>
<li>mount –t glusterfs nodeX:VOLNAME &#x2F;mnt</li>
</ul>
</li>
<li><p>客户端</p>
<ul>
<li>yum install –y cifs-utils</li>
<li>yum install –y sambe-client*</li>
<li>验证samba共享目录smbclient –L nodeX –U%</li>
<li>使用smbuser进行挂载 mount –t cifs –o user&#x3D;smbuser,pass&#x3D;XXX&#x2F;&#x2F;nodeX&#x2F;VOLNAME &#x2F;mnt</li>
</ul>
</li>
</ul>
<h4 id="4-5-6-部署Gluster客户端"><a href="#4-5-6-部署Gluster客户端" class="headerlink" title="4.5.6 部署Gluster客户端"></a>4.5.6 部署Gluster客户端</h4><ul>
<li>安装客户端服务<ul>
<li><code>yum install -y glusterfs glusterfs-fuse</code></li>
</ul>
</li>
<li>客户端添加地址解析，添加到所有存储节点的解析</li>
<li>创建挂载点并进行挂载<ul>
<li><code>mount -t glusterfs nodeX:NEW-VOLNAME /mnt/XX</code></li>
</ul>
</li>
<li>开机自动挂载，编辑<code>/etc/fstab</code>文件<ul>
<li><code>nodeX:NEW-VOLNAME /mnt/XX glusterfs defauts,_netdev 0 0</code></li>
</ul>
</li>
<li>自动挂载格式：<code>HOSTNAME-OR-IPADDRESS:/VOLNAME MOUNTDIR glusterfs defaults,_netdev 0 0</code></li>
</ul>
<h3 id="4-6-GlusterFS卷管理"><a href="#4-6-GlusterFS卷管理" class="headerlink" title="4.6 GlusterFS卷管理"></a>4.6 GlusterFS卷管理</h3><h4 id="4-6-1-启用、停止、查看和再平衡"><a href="#4-6-1-启用、停止、查看和再平衡" class="headerlink" title="4.6.1 启用、停止、查看和再平衡"></a>4.6.1 启用、停止、查看和再平衡</h4><ul>
<li>启用卷<ul>
<li><code>gluster volume start VOLNAME</code></li>
</ul>
</li>
<li>停止卷<ul>
<li><code>gluster volume stop VOLNAME</code></li>
</ul>
</li>
<li>查看卷信息<ul>
<li>查看单独卷状态：gluster volume status VOLNAME</li>
<li>查看卷信息：gluster volume info</li>
</ul>
</li>
<li>再平衡卷<ul>
<li>gluster volume rebalance VOLNAME start</li>
<li>gluster volume rebalance VOLNAME status</li>
</ul>
</li>
</ul>
<h4 id="4-6-2-删除卷"><a href="#4-6-2-删除卷" class="headerlink" title="4.6.2 删除卷"></a>4.6.2 删除卷</h4><ul>
<li>先停止卷<ul>
<li><code>gluster volume stop VOLNAME</code></li>
</ul>
</li>
<li>再执行删除卷<ul>
<li><code>gluster volume delete VOLNAME</code></li>
</ul>
</li>
<li>删除卷之后，释放的brick无法直接使用，需要在对应brick目录中，删除“.glusterfs”开头的隐藏文件，再执行如下两条命令后，才可以继续使用：<ul>
<li><code>setfattr -x trusted.glusterfs.volume-id /BRICK</code></li>
<li><code>setfattr -x trusted.gfid /BRICK</code></li>
</ul>
</li>
<li><code>setfattr -x trusted.glusterfs.volume-id</code> 用于删除文件或目录的扩展属性，其中<code>trusted.glusterfs.volume-id</code>是 GlusterFS 文件系统中的一个扩展属性，用于标识文件所属的 GlusterFS 卷</li>
<li><code>setfattr -x trusted.gfid</code>用于删除文件或目录的GFID（Global File Identifier）属性。GFID是GlusterFS文件系统中用于唯一标识文件或目录的属性。使用该命令可以删除GFID属性，但不会删除文件或目录本身</li>
</ul>
<h4 id="4-6-3-扩容和缩容"><a href="#4-6-3-扩容和缩容" class="headerlink" title="4.6.3 扩容和缩容"></a>4.6.3 扩容和缩容</h4><ul>
<li><p>在线扩容与缩容</p>
<ul>
<li>在线扩容volume</li>
<li><code>gluster volume add-brick VOLNAME NEW-BRICK</code></li>
</ul>
</li>
<li><p>在线缩容</p>
<ul>
<li>删除brick：<code>gluster volume remove-brick VOLNAME BRICKNAME start</code></li>
<li>查看操作状态：<code>gluster volume remove-brick VOLNAME BRICKNAME status</code></li>
<li>状态completed后，提交缩容操作：<code>gluster volume remove-brick VOLNAME BRICKNAME commit</code></li>
</ul>
</li>
<li><p>glusterfs中卷新增brick后，需要重新平衡布局后才可以使用该brick</p>
<ul>
<li>gluster volume rebalance VOLNAME start</li>
<li>gluster volume rebalance VOLNAME status</li>
</ul>
</li>
<li><p>通常扩容后需要手动执行再平衡命令，防止出现旧节点负载过高而出现性能问题，影响数据可靠性和可用性。缩容时系统会自动触发再平衡，避免剔除的节点或者子卷中的数据不可用，从而导致数据丢失</p>
</li>
</ul>
<h4 id="4-6-3-替换损坏的brick"><a href="#4-6-3-替换损坏的brick" class="headerlink" title="4.6.3 替换损坏的brick"></a>4.6.3 替换损坏的brick</h4><ul>
<li>在服务器端查看故障brick进程PID，并结束该进程<ul>
<li><code>kill -15 PID</code></li>
</ul>
</li>
<li>客户端卸载包含故障brick的卷</li>
<li>客户端重新挂载卷到新的挂载点&lt;客户端挂载点&gt;</li>
<li>查询查询故障节点的备份节点目的扩展属性:<code>getfattr -d-m.-e hex BRICK</code></li>
<li>客户端新建目录并删除<ul>
<li>cd&lt;客户端挂载点&gt;</li>
<li>mkdir testDir</li>
<li>rm -rf test Dir</li>
</ul>
</li>
<li>设置扩展属性触发自愈<ul>
<li>&#96;setfattr -n trusted.non-existent-key -v abc &lt;客户端挂载点&gt;</li>
<li><code>setfattr -x trusted.non-existent-key &lt;客户端挂载点&gt;</code></li>
</ul>
</li>
<li>强制替换卷<ul>
<li><code>gluster volume replace-brick VOLNAME BAD-BRICK NEW-BRICK commit force</code></li>
</ul>
</li>
<li>扩展属性是现代文件系统普遍支持，而又不容易被用户发现的特性。Glusterfs中DHT，AFT，stripe都广泛使用了扩展属性即xattr。xattr是一个key-value结构， 包括一个字符串key, 和一个二进制的value</li>
<li>在glusterfs中 当set&#x2F;get xattr的时候，会触发gluster server的相关操作</li>
<li>每当添加&#x2F;删除一个brick的时候，要重新计算xattr中存放的哈希区间</li>
<li>比如一个叫test1的afr卷，由test1-client-0和test1-client-1两个brick组成。 那么test1-client-0上的文件就会具有名为 trusted.afr.test1-client-1的xattr。在一个brick上的操作会在其他所有brick上的xattr中记录</li>
</ul>
<h2 id="0x05-缩略语"><a href="#0x05-缩略语" class="headerlink" title="0x05 缩略语"></a>0x05 缩略语</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/file-20250519034104829.png"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">XBCID</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/')">03 openEuler存储管理</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=03 openEuler存储管理&amp;url=http://example.com/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/03%20openEuler%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">XBCID's BLOG</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Linux/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Linux<span class="tagsPageCount">18</span></a><a class="post-meta__box__tags" href="/tags/openEuler/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>openEuler<span class="tagsPageCount">18</span></a><a class="post-meta__box__tags" href="/tags/Huawei/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Huawei<span class="tagsPageCount">15</span></a><a class="post-meta__box__tags" href="/tags/HCIP/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>HCIP<span class="tagsPageCount">6</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/03/08/openEuler/%E7%AC%94%E8%AE%B0/IP/06%20openEuler%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">06 openEuler操作系统安全加固</div></div></a></div><div class="next-post pull-right"><a href="/2025/05/19/openEuler/%E5%AE%9E%E9%AA%8C/IA/01%20openEuler%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info"></div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IP/01%20openEuler%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86/" title="01 openEuler操作系统入门"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">01 openEuler操作系统入门</div></div></a></div><div><a href="/2025/03/06/openEuler/%E7%AC%94%E8%AE%B0/IP/05%20shell%E8%84%9A%E6%9C%AC%E8%BF%9B%E9%98%B6/" title="05 shell脚本进阶"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-03-06</div><div class="title">05 shell脚本进阶</div></div></a></div><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IP/04%20%E8%87%AA%E5%8A%A8%E5%8C%96%E7%AE%A1%E7%90%86/" title="04 自动化管理"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">04 自动化管理</div></div></a></div><div><a href="/2025/03/08/openEuler/%E7%AC%94%E8%AE%B0/IP/06%20openEuler%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/" title="06 openEuler操作系统安全加固"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-03-08</div><div class="title">06 openEuler操作系统安全加固</div></div></a></div><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IA/01%20openEuler%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8/" title="01 openEuler操作系统入门"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">01 openEuler操作系统入门</div></div></a></div><div><a href="/2025/02/14/openEuler/%E7%AC%94%E8%AE%B0/IA/02%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%93%8D%E4%BD%9C%E5%9F%BA%E7%A1%80/" title="02 命令行操作基础"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-02-14</div><div class="title">02 命令行操作基础</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E5%AD%98%E5%82%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">0x01 存储的基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE"><span class="toc-number">1.1.</span> <span class="toc-text">1. 什么是数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BB%80%E4%B9%88%E6%98%AF%E4%BF%A1%E6%81%AF"><span class="toc-number">1.2.</span> <span class="toc-text">2. 什么是信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.</span> <span class="toc-text">3. 存储介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E5%AD%98%E5%82%A8%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 存储基本介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E5%AD%98%E5%82%A8%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E8%BF%9B"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 存储架构的演进</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-%E5%AD%98%E5%82%A8%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">2.</span> <span class="toc-text">0x02 存储的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%AD%98%E5%82%A8%E5%88%86%E7%B1%BB-%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 存储分类 - 使用方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%AD%98%E5%82%A8%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 存储分类 - 数据存储方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%AD%98%E5%82%A8%E5%88%86%E7%B1%BB-%E5%AD%98%E5%82%A8%E4%BB%8B%E8%B4%A8%E5%AD%98%E6%94%BE%E4%BD%8D%E7%BD%AE"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 存储分类 - 存储介质存放位置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-%E5%85%B1%E4%BA%AB%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text">0x03 共享存储介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-NAS"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 NAS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-NAS%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.1.</span> <span class="toc-text">3.1.1 NAS简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-NAS%E6%9E%B6%E6%9E%84"><span class="toc-number">3.1.2.</span> <span class="toc-text">3.1.2 NAS架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-NAS%E5%B8%B8%E8%A7%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.1.3 NAS常见协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-4-NAS%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">3.1.4.</span> <span class="toc-text">3.1.4 NAS的特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-5-NAS%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">3.1.5.</span> <span class="toc-text">3.1.5 NAS的使用场景</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-NFS"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 NFS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-NFS%E7%AE%80%E4%BB%8B"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 NFS简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-NFS%E6%9C%8D%E5%8A%A1%E6%89%80%E9%9C%80%E8%BD%AF%E4%BB%B6"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 NFS服务所需软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-NFS%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3 NFS工作机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-NFS%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85"><span class="toc-number">3.2.4.</span> <span class="toc-text">3.2.4 NFS服务器安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-5-NFS%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">3.2.5.</span> <span class="toc-text">3.2.5 NFS服务器配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-6-NFS%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">3.2.6.</span> <span class="toc-text">3.2.6 NFS客户端配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%AD%98%E5%82%A8%E5%8C%BA%E5%9F%9F%E7%BD%91%E7%BB%9CSAN"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 存储区域网络SAN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-SAN%E7%AE%80%E4%BB%8B"><span class="toc-number">3.3.1.</span> <span class="toc-text">3.3.1 SAN简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-iSCSI"><span class="toc-number">3.3.2.</span> <span class="toc-text">3.3.2 iSCSI</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-2-1-iSCSI%E7%AE%80%E4%BB%8B"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">3.3.2.1 iSCSI简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-2-2-iSCSI%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">3.3.2.2 iSCSI的基本组成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-2-3-IQN%E7%AE%80%E4%BB%8B"><span class="toc-number">3.3.2.3.</span> <span class="toc-text">3.3.2.3 IQN简介</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-%E5%9F%BA%E4%BA%8ELinux%E7%9A%84SAN%E9%85%8D%E7%BD%AE%E6%B5%81%E7%A8%8B"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.3.3 基于Linux的SAN配置流程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-3-1-Target%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">3.3.3.1 Target配置方法</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#3-3-3-1-1-Tgtadm%E7%AE%80%E4%BB%8B"><span class="toc-number">3.3.3.1.1.</span> <span class="toc-text">3.3.3.1.1 Tgtadm简介</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-3-3-1-2-Tgtadm%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-number">3.3.3.1.2.</span> <span class="toc-text">3.3.3.1.2 Tgtadm常用参数</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-3-3-1-3-Target%E6%B0%B8%E4%B9%85%E9%85%8D%E7%BD%AE-%E7%BC%96%E8%BE%91%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.3.1.3.</span> <span class="toc-text">3.3.3.1.3 Target永久配置 - 编辑配置文件</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-3-2-Target%E9%85%8D%E7%BD%AE%E6%A1%88%E4%BE%8B"><span class="toc-number">3.3.3.2.</span> <span class="toc-text">3.3.3.2 Target配置案例</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.</span> <span class="toc-text">0x04 分布式存储介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%B8%B8%E8%A7%81%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E6%9E%B6%E6%9E%84"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 常见的分布式存储架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-GlusterFS%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 GlusterFS的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-GlusterFS%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E5%8A%9F%E8%83%BD%E7%89%B9%E7%82%B9"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 GlusterFS分布式存储功能特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-GlusterFS%E6%9E%B6%E6%9E%84"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 GlusterFS架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-GlusterFS%E5%B8%B8%E8%A7%81%E5%8D%B7%E6%A8%A1%E5%BC%8F%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.5.</span> <span class="toc-text">4.4 GlusterFS常见卷模式介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-%E5%88%86%E5%B8%83%E5%BC%8F%E5%8D%B7-Distributed-Glusterfs-Volume"><span class="toc-number">4.5.1.</span> <span class="toc-text">4.4.1 分布式卷 Distributed Glusterfs Volume</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-%E5%A4%8D%E5%88%B6%E5%8D%B7-Replicated-Glusterfs-Volume"><span class="toc-number">4.5.2.</span> <span class="toc-text">4.4.2 复制卷 Replicated Glusterfs Volume</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%8D%E5%88%B6%E5%8D%B7-Distributed-Replicated-Glusterfs-Volume"><span class="toc-number">4.5.3.</span> <span class="toc-text">4.4.3 分布式复制卷 Distributed Replicated Glusterfs Volume</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-4-%E5%88%86%E6%95%A3%E5%8D%B7-Dispersed-Glusterfs-Volume"><span class="toc-number">4.5.4.</span> <span class="toc-text">4.4.4 分散卷 Dispersed Glusterfs Volume</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-5-%E5%88%86%E5%B8%83%E5%BC%8F%E5%88%86%E6%95%A3%E5%8D%B7Distributed-Dispersed-Glusterfs-Volume"><span class="toc-number">4.5.5.</span> <span class="toc-text">4.4.5 分布式分散卷Distributed Dispersed Glusterfs Volume</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2GlusterFS"><span class="toc-number">4.6.</span> <span class="toc-text">4.5 安装部署GlusterFS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-1-%E6%B5%81%E7%A8%8B"><span class="toc-number">4.6.1.</span> <span class="toc-text">4.5.1 流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-2-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%92%8C%E6%8C%82%E8%BD%BDbricks"><span class="toc-number">4.6.2.</span> <span class="toc-text">4.5.2 格式化和挂载bricks</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-3-%E5%8D%B7%E5%88%9B%E5%BB%BA"><span class="toc-number">4.6.3.</span> <span class="toc-text">4.5.3 卷创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-4-%E9%85%8D%E7%BD%AE%E9%98%B2%E7%81%AB%E5%A2%99%E5%8F%8Atrusted-pool"><span class="toc-number">4.6.4.</span> <span class="toc-text">4.5.4 配置防火墙及trusted pool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-5-%E5%8D%B7%E6%8C%82%E8%BD%BD"><span class="toc-number">4.6.5.</span> <span class="toc-text">4.5.5 卷挂载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-6-%E9%83%A8%E7%BD%B2Gluster%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">4.6.6.</span> <span class="toc-text">4.5.6 部署Gluster客户端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-GlusterFS%E5%8D%B7%E7%AE%A1%E7%90%86"><span class="toc-number">4.7.</span> <span class="toc-text">4.6 GlusterFS卷管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-1-%E5%90%AF%E7%94%A8%E3%80%81%E5%81%9C%E6%AD%A2%E3%80%81%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%86%8D%E5%B9%B3%E8%A1%A1"><span class="toc-number">4.7.1.</span> <span class="toc-text">4.6.1 启用、停止、查看和再平衡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-2-%E5%88%A0%E9%99%A4%E5%8D%B7"><span class="toc-number">4.7.2.</span> <span class="toc-text">4.6.2 删除卷</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-3-%E6%89%A9%E5%AE%B9%E5%92%8C%E7%BC%A9%E5%AE%B9"><span class="toc-number">4.7.3.</span> <span class="toc-text">4.6.3 扩容和缩容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-3-%E6%9B%BF%E6%8D%A2%E6%8D%9F%E5%9D%8F%E7%9A%84brick"><span class="toc-number">4.7.4.</span> <span class="toc-text">4.6.3 替换损坏的brick</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-%E7%BC%A9%E7%95%A5%E8%AF%AD"><span class="toc-number">5.</span> <span class="toc-text">0x05 缩略语</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IP/07%20openEuler%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%85%A5%E9%97%A8/" title="无题">无题</a><time datetime="2025-05-18T19:46:45.900Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/%E6%B3%A8%E9%87%8A/shebang/" title="无题">无题</a><time datetime="2025-05-18T19:46:45.880Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/10%20%E5%B8%B8%E7%94%A8%E5%B0%8F%E6%8C%87%E4%BB%A4/" title="无题">无题</a><time datetime="2025-05-18T19:46:45.685Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/09%20Samba%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86/" title="09 Samba文件共享服务器管理">09 Samba文件共享服务器管理</a><time datetime="2025-05-18T19:46:45.684Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/19/openEuler/%E7%AC%94%E8%AE%B0/IA/08%20%E4%BD%BF%E7%94%A8shell%E8%84%9A%E6%9C%AC/" title="08 使用shell脚本">08 使用shell脚本</a><time datetime="2025-05-18T19:46:45.683Z" title="发表于 2025-05-19 03:46:45">2025-05-19</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="XBCID" target="_blank">XBCID</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">37</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HCIA/" style="font-size: 0.88rem;">HCIA<sup>9</sup></a><a href="/tags/HCIP/" style="font-size: 0.88rem;">HCIP<sup>6</sup></a><a href="/tags/Huawei/" style="font-size: 0.88rem;">Huawei<sup>15</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>18</sup></a><a href="/tags/openEuler/" style="font-size: 0.88rem;">openEuler<sup>18</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("01/12/2021 14:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 XBCID 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>